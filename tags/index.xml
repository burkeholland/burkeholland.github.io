<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Tags on Burke Knows Words</title><link>https://burkeholland.github.io</link><description>Recent content in Tags on Burke Knows Words</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><atom:link href="https://burkeholland.github.io/tags/index.xml" rel="self" type="application/rss+xml"/><item><title>Running Express and React in the same project</title><link>https://burkeholland.github.io/posts/express-react-starter-refresh/</link><pubDate>Thu, 12 May 2022 16:54:06 -0500</pubDate><guid>https://burkeholland.github.io/posts/express-react-starter-refresh/</guid><description>&lt;p>All of us have, at some point, stood in front of a mirror looking into our own soul and asked the question that every JavaScript developer is destined to ask before they die - &amp;ldquo;How do you run Express and React in the same project&amp;rdquo;?&lt;/p>
&lt;p>This week I revisited my answer to that existential nightmare in the form of a refresh to the &lt;a href="https://github.com/burkeholland/express-react-starter">Express React Starter&lt;/a>. Because I feel a desperate need to get &lt;em>some&lt;/em> content out this week AND the original blog post on the subject is completely AFK, here&amp;rsquo;s another run down of how I use Express to serve up React.&lt;/p>
&lt;p>First - a disclaimer&amp;hellip;&lt;/p>
&lt;h3 id="why-run-express-and-react-in-the-same-project">Why run Express and React in the same project?&lt;/h3>
&lt;p>Well, there are a lot of reasons, but the most fundamental one is because &lt;strong>I want to&lt;/strong>. And let me just say, it&amp;rsquo;s way harder than it should be. My goodness - it&amp;rsquo;s a website. All of this has gotten way out of hand, but so many people have already written that blog post and I certainly can&amp;rsquo;t say &amp;ldquo;get off my lawn&amp;rdquo; better than they can.&lt;/p>
&lt;p>The point is that I am acknowledging that it&amp;rsquo;s way easier to run the React app in one project and the API in another and avoid this problem entirely.&lt;/p>
&lt;p>But what if you had a single app instance where you wanted to host your app in your preferred cloud provider? You would have to pay for a second to host the API, and maybe you don&amp;rsquo;t want to do that. Or maybe you just think everything is cleaner with a single project and not pointlessly running in multiple locations. And also, you did ASP.NET Webforms back in the day baby, back when all the logic for a web app was self-contained and pages were assembled on the server the way god intended - way before &amp;ldquo;JavaScript&amp;rdquo; was considered even a remotely good idea to do anything at all other than disable the back button because SOME MEN JUST WANT TO WATCH THE WORLD BURN.&lt;/p>
&lt;p>&lt;img src="https://i.kym-cdn.com/photos/images/newsfeed/000/505/362/3f4.gif" alt="">&lt;/p>
&lt;h3 id="express-react-starter">Express React Starter&lt;/h3>
&lt;p>Express React Starter (ERS - pronounced &amp;ldquo;ears&amp;rdquo;, because I made it and therefore you have to pronounce it anyway I say) is a template, but really more of an example on how to go about setting this up. It&amp;rsquo;s a static GitHub project and therefore can&amp;rsquo;t possibly keep up with changes in create-react-app. Let&amp;rsquo;s take a look at how I put it together so you can tell me why it&amp;rsquo;s wrong.&lt;/p>
&lt;p>I start with a fresh &amp;ldquo;create-react-app&amp;rdquo; scaffold.&lt;/p>
&lt;p>&lt;code>npx create-react-app@latest project-name&lt;/code>&lt;/p>
&lt;p>Then I add in Express directly to this project into a folder called &amp;ldquo;server&amp;rdquo;.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>npx express-generator server
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cd server &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> npm i
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>So now we have a project structure that looks like this&amp;hellip;&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-text" data-lang="text">&lt;span style="display:flex;">&lt;span>🗂 node_modules
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>🗂 public
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>🗂 server
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>🗂 src
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>📄 .gitignore
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>📄 package-lock.json
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>📄 package.json
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>📄 README.MD
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="configuring-express-to-serve-as-the-api">Configuring Express to serve as the API&lt;/h3>
&lt;p>What we want from Express in this situations is to serve up the website in production (in development the webpack dev server will do that) and to serve as the API. To do that, we need to tell Express to serve up anything it sees on the &amp;ldquo;api&amp;rdquo; route. Anything it doesn&amp;rsquo;t recognize, just return the &amp;ldquo;index&amp;rdquo; page because React is handling all other routing. We also need to tweak the &lt;code>express.static&lt;/code> path because the &amp;ldquo;index.html&amp;rdquo; file is going to be in a folder called &amp;ldquo;build&amp;rdquo; when we eventually run &lt;code>npm run build&lt;/code>.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">app&lt;/span>.&lt;span style="color:#a6e22e">use&lt;/span>(&lt;span style="color:#a6e22e">express&lt;/span>.&lt;span style="color:#66d9ef">static&lt;/span>(&lt;span style="color:#a6e22e">path&lt;/span>.&lt;span style="color:#a6e22e">join&lt;/span>(&lt;span style="color:#a6e22e">__dirname&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;build&amp;#34;&lt;/span>)));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">app&lt;/span>.&lt;span style="color:#a6e22e">use&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;/api&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">indexRouter&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">app&lt;/span>.&lt;span style="color:#a6e22e">get&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;*&amp;#34;&lt;/span>, (&lt;span style="color:#a6e22e">req&lt;/span>, &lt;span style="color:#a6e22e">res&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">res&lt;/span>.&lt;span style="color:#a6e22e">sendFile&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;client/index.html&amp;#34;&lt;/span>, { &lt;span style="color:#a6e22e">root&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">global&lt;/span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>});
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;p>We modify the express.static route as well because when we run the build, the index file will be in the &amp;ldquo;build&amp;rdquo; folder. Look - I told you this was way harder than it should be.&lt;/p>
&lt;/blockquote>
&lt;p>Now we can setup a sample route in &lt;code>server/routes/index.js&lt;/code> and return some data from the API&amp;hellip;&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">/* GET /api/message */&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">router&lt;/span>.&lt;span style="color:#a6e22e">get&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;/message&amp;#34;&lt;/span>, &lt;span style="color:#66d9ef">function&lt;/span> (&lt;span style="color:#a6e22e">req&lt;/span>, &lt;span style="color:#a6e22e">res&lt;/span>, &lt;span style="color:#a6e22e">next&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">res&lt;/span>.&lt;span style="color:#a6e22e">json&lt;/span>({ &lt;span style="color:#a6e22e">message&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;Hello from the API!&amp;#34;&lt;/span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>});
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>That sets up Express to handle requests correctly. We just need to inform React of how to send any request to &amp;ldquo;/api&amp;rdquo; to the Express server. So the next step is like every other problem in America at the moment - getting these two things to talk to each other.&lt;/p>
&lt;h3 id="talking-to-express-from-react">Talking to Express from React&lt;/h3>
&lt;p>When you&amp;rsquo;re in development, React is going to handle any and all URLs you try and call. So if you tried to go to &lt;code>https://localhost:3000/not/here&lt;/code>, you just get sent back to &amp;ldquo;index.html&amp;rdquo;. But we can instruct React to send any request that it doesn&amp;rsquo;t recognize to our Express server which runs on port 3000. That is done via the &amp;ldquo;proxy&amp;rdquo; attribute in the &amp;ldquo;package.json&amp;rdquo; file..&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#34;proxy&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;http://localhost:3000&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&amp;ldquo;But wait! Isn&amp;rsquo;t the React app already running on port 3000?!?&amp;rdquo;. YES. We&amp;rsquo;ll get to that - one thing at a time please.&lt;/p>
&lt;p>Let&amp;rsquo;s modify the &lt;code>src/App.js&lt;/code> file to do a fetch to our Express API for some data.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">import&lt;/span> { &lt;span style="color:#a6e22e">useEffect&lt;/span>, &lt;span style="color:#a6e22e">useState&lt;/span> } &lt;span style="color:#a6e22e">from&lt;/span> &lt;span style="color:#e6db74">&amp;#34;react&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">import&lt;/span> &lt;span style="color:#a6e22e">logo&lt;/span> &lt;span style="color:#a6e22e">from&lt;/span> &lt;span style="color:#e6db74">&amp;#34;./logo.svg&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">import&lt;/span> &lt;span style="color:#e6db74">&amp;#34;./App.css&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">App&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> [&lt;span style="color:#a6e22e">message&lt;/span>, &lt;span style="color:#a6e22e">setMessage&lt;/span>] &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">useState&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">useEffect&lt;/span>(() =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">getMessage&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }, []);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">async&lt;/span> &lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">getMessage&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">result&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">fetch&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;/api/message&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">json&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">result&lt;/span>.&lt;span style="color:#a6e22e">json&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">setMessage&lt;/span>(&lt;span style="color:#a6e22e">json&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> (
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#a6e22e">div&lt;/span> &lt;span style="color:#a6e22e">className&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;App&amp;#34;&lt;/span>&lt;span style="color:#f92672">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#a6e22e">header&lt;/span> &lt;span style="color:#a6e22e">className&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;App-header&amp;#34;&lt;/span>&lt;span style="color:#f92672">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#a6e22e">img&lt;/span> &lt;span style="color:#a6e22e">src&lt;/span>&lt;span style="color:#f92672">=&lt;/span>{&lt;span style="color:#a6e22e">logo&lt;/span>} &lt;span style="color:#a6e22e">className&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;App-logo&amp;#34;&lt;/span> &lt;span style="color:#a6e22e">alt&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;logo&amp;#34;&lt;/span> &lt;span style="color:#f92672">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#a6e22e">p&lt;/span>&lt;span style="color:#f92672">&amp;gt;&lt;/span>{&lt;span style="color:#a6e22e">message&lt;/span>.&lt;span style="color:#a6e22e">message&lt;/span>}&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">/p&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#a6e22e">a&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">className&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;App-link&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">href&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;https://reactjs.org&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">target&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;_blank&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">rel&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;noopener noreferrer&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">Learn&lt;/span> &lt;span style="color:#a6e22e">React&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">/a&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">/header&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">/div&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> );
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">export&lt;/span> &lt;span style="color:#66d9ef">default&lt;/span> &lt;span style="color:#a6e22e">App&lt;/span>;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>OK! We&amp;rsquo;re ready to fire this monstrosity up. We need to modify our &lt;code>start&lt;/code> command so that the React app starts on port 3001 since Express has already laid claim to 3000.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#34;scripts&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;start&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;PORT=3001 react-scripts start&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>I used to try and run both the React Frontend AND the API in the same &lt;code>start&lt;/code> command, but it&amp;rsquo;s messy and I hate it. So instead, just run it in separate terminal tabs.&lt;/p>
&lt;p>Start the backend&amp;hellip;
&lt;code>cd server &amp;amp;&amp;amp; npm start&lt;/code>&lt;/p>
&lt;p>Start the frontend&amp;hellip;
&lt;code>npm start&lt;/code>&lt;/p>
&lt;p>In VS Code you can right-click / rename those terminal tabs so you can keep track of what&amp;rsquo;s what&amp;hellip;&lt;/p>
&lt;p>&lt;img src="https://burkeholland.github.io/media/terminal-tabs.png" alt="">&lt;/p>
&lt;p>And you can find this monster running at http://localhost:3001.&lt;/p>
&lt;p>&lt;img src="https://burkeholland.github.io/media/hello-from-api.png" alt="">&lt;/p>
&lt;p>That&amp;rsquo;s the stuff! And just when you thought we were done, let&amp;rsquo;s talk about going to production with this thing&amp;hellip;&lt;/p>
&lt;h3 id="building-for-production">Building for production&lt;/h3>
&lt;p>It&amp;rsquo;s really not that bad. All we want to do here is build the frontend and drop the &amp;ldquo;build&amp;rdquo; in the &amp;ldquo;server&amp;rdquo; folder. A simple &lt;code>mv&lt;/code> command &lt;em>should&lt;/em> have been enough, but since there is no cross-platform equivalent, I add a simple &lt;code>copy.js&lt;/code> file to the project root.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// This is a simple script to copy the &amp;#34;build&amp;#34; folder to the &amp;#34;server&amp;#34; directory
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">const&lt;/span> { &lt;span style="color:#a6e22e">promises&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">fs&lt;/span> } &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;fs&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">path&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;path&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">async&lt;/span> &lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">copyDir&lt;/span>(&lt;span style="color:#a6e22e">src&lt;/span>, &lt;span style="color:#a6e22e">dest&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">fs&lt;/span>.&lt;span style="color:#a6e22e">mkdir&lt;/span>(&lt;span style="color:#a6e22e">dest&lt;/span>, { &lt;span style="color:#a6e22e">recursive&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> &lt;span style="color:#a6e22e">entries&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">fs&lt;/span>.&lt;span style="color:#a6e22e">readdir&lt;/span>(&lt;span style="color:#a6e22e">src&lt;/span>, { &lt;span style="color:#a6e22e">withFileTypes&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> (&lt;span style="color:#66d9ef">let&lt;/span> &lt;span style="color:#a6e22e">entry&lt;/span> &lt;span style="color:#66d9ef">of&lt;/span> &lt;span style="color:#a6e22e">entries&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> &lt;span style="color:#a6e22e">srcPath&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">path&lt;/span>.&lt;span style="color:#a6e22e">join&lt;/span>(&lt;span style="color:#a6e22e">src&lt;/span>, &lt;span style="color:#a6e22e">entry&lt;/span>.&lt;span style="color:#a6e22e">name&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> &lt;span style="color:#a6e22e">destPath&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">path&lt;/span>.&lt;span style="color:#a6e22e">join&lt;/span>(&lt;span style="color:#a6e22e">dest&lt;/span>, &lt;span style="color:#a6e22e">entry&lt;/span>.&lt;span style="color:#a6e22e">name&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">entry&lt;/span>.&lt;span style="color:#a6e22e">isDirectory&lt;/span>()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">?&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">copyDir&lt;/span>(&lt;span style="color:#a6e22e">srcPath&lt;/span>, &lt;span style="color:#a6e22e">destPath&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">fs&lt;/span>.&lt;span style="color:#a6e22e">copyFile&lt;/span>(&lt;span style="color:#a6e22e">srcPath&lt;/span>, &lt;span style="color:#a6e22e">destPath&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">async&lt;/span> &lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">copyDir&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;build&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;server/build&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">main&lt;/span>();
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Then modify the &amp;ldquo;build&amp;rdquo; command in the main &amp;ldquo;package.json&amp;rdquo; to call this &amp;ldquo;copy.js&amp;rdquo; file&amp;hellip;&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#34;build&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;react-scripts build &amp;amp;&amp;amp; node copy.js&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">,&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Then run your build&amp;hellip;&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>npm run build
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>The &amp;ldquo;server&amp;rdquo; folder now contains your entire built project. To run it&amp;hellip;&lt;/p>
&lt;pre tabindex="0">&lt;code>cd server &amp;amp;&amp;amp; npm start
&lt;/code>&lt;/pre>&lt;p>If you were going to production, you would just deploy that server folder.&lt;/p>
&lt;h3 id="things-i-hate-about-this">Things I hate about this&lt;/h3>
&lt;p>There are so many, but just a few things I hate about this setup&amp;hellip;.&lt;/p>
&lt;ol>
&lt;li>Two package.json files. It&amp;rsquo;s wrong and nobody can change my mind on that.&lt;/li>
&lt;li>Starting two processes in two separate tabs. I really wanted that &amp;ldquo;F5&amp;rdquo; feeling where you just press the green play button and everything magically works.&lt;/li>
&lt;li>The &amp;ldquo;server&amp;rdquo; folder as the output feels wrong. Output folders should be called &amp;ldquo;dist&amp;rdquo;. Maybe the &amp;ldquo;copy.js&amp;rdquo; file should copy everything to dist?&lt;/li>
&lt;/ol>
&lt;p>I can&amp;rsquo;t solve all the world&amp;rsquo;s problems. But I can offer you this humble Express React Starter. Check it out &lt;a href="https://github.com/burkeholland/express-react-starter">on GitHub&lt;/a>.&lt;/p>
&lt;p>❤️&lt;/p></description></item><item><title>How to add your dotfiles to GitHub Codespaces</title><link>https://burkeholland.github.io/posts/codespaces-dotfiles/</link><pubDate>Fri, 29 Oct 2021 11:44:36 -0500</pubDate><guid>https://burkeholland.github.io/posts/codespaces-dotfiles/</guid><description>&lt;p>One of the first things you are gonna realize after you get started with Codespaces, is that you desperately want your own custom environment setup that you enjoy locally to somehow magically be in Codespaces as well. You can do that using a &amp;ldquo;dotfiles&amp;rdquo; repo, and in this post, we&amp;rsquo;re going to look at how to setup a dotfiles repo, and what quirks you need to be aware of to use it with Codespaces.&lt;/p>
&lt;h2 id="whats-a-dotfile">What&amp;rsquo;s a dotfile?&lt;/h2>
&lt;p>A &amp;ldquo;dotfile&amp;rdquo; is any configuration files that start with a dot. You can view your dotfiles by going to your home directory on your machine (&lt;code>cd ~&lt;/code>) and running &lt;code>ls -al&lt;/code>. For instance, the &amp;ldquo;.zshrc&amp;rdquo; file allows you to tweak how your shell (terminal) looks and works. Behold, the glory of my terminal in Codespaces - powered by my .zshrc file&amp;hellip;&lt;/p>
&lt;p>&lt;img src="https://burkeholland.github.io/media/terminal-glory.jpg" alt="codespaces terminal running zsh">&lt;/p>
&lt;p>For this post, we&amp;rsquo;re only going to focus on the &amp;ldquo;.zshrc&amp;rdquo; file as that&amp;rsquo;s where all of my terminal configuration can be found. But this post isn&amp;rsquo;t about oh-my-zsh and how it&amp;rsquo;s the best shell and that&amp;rsquo;s not up for debate. This process will work for any dotfiles.&lt;/p>
&lt;p>People like things that come in steps, so here you go&amp;hellip;&lt;/p>
&lt;h2 id="step-1-setup-a-dotfiles-github-repo">Step 1. Setup a dotfiles GitHub repo&lt;/h2>
&lt;p>It&amp;rsquo;s common practice to put your dotfiles in a GitHub repo. There are plenty of blog posts that will tell you all about how to setup the repo, create symlinks, keep everything in sync with cron jobs or something - I don&amp;rsquo;t know. I didn&amp;rsquo;t actually read them. It&amp;rsquo;s the internet and I&amp;rsquo;m too busy to do my own research.&lt;/p>
&lt;p>All you need to know for now is that you need to create a GitHub repo called &amp;ldquo;dotfiles&amp;rdquo;. Convention over configuration and all of that, but no surprise there because GitHub is a Rails app after all.&lt;/p>
&lt;p>So create the &amp;ldquo;dotfiles&amp;rdquo; repo on GitHub and then on to step 2.&lt;/p>
&lt;h2 id="step-2-add-your-dotfiles">Step 2. Add your dotfiles&lt;/h2>
&lt;p>Copy just the &amp;ldquo;.zshrc&amp;rdquo; file into your &amp;ldquo;dotfiles&amp;rdquo; project. That&amp;rsquo;s all there is for step 2. A paragraph has at last 3 sentences.&lt;/p>
&lt;h2 id="step-3-update-your-zshrc-file">Step 3. Update your .zshrc file&lt;/h2>
&lt;p>Your &amp;ldquo;.zshrc&amp;rdquo; file needs a little updating. You need to find anywhere that references your home path directly and replace it with the HOME environment variable. This is because Codespaces don&amp;rsquo;t run under your account so the directory structure is doing to be a bit different.&lt;/p>
&lt;p>&lt;strong>BEFORE&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Path to your oh-my-zsh installation.&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>export ZSH&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;/home/burkeholland/.oh-my-zsh&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;strong>AFTER&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Path to your oh-my-zsh installation.&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>export ZSH&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>HOME&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">/.oh-my-zsh&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Now you can add whatever you like - themes, plugins, stuff you copied and pasted from StackOverflow and you don&amp;rsquo;t remember what it does. You know - all the stuff you normally do in your &amp;ldquo;.zshrc&amp;rdquo; file. To keep it simple, I&amp;rsquo;m just going to do a theme and plugins, but we&amp;rsquo;ll throw a wrench in here and use plugins that need to be installed separately and then cover how to do that. So here&amp;rsquo;s our completed sample &amp;ldquo;.zshrc&amp;rdquo; file. Don&amp;rsquo;t forget to source &lt;code>oh-my-zsh.sh&lt;/code>!&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Path to your oh-my-zsh installation.&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>export ZSH&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>$HOME&lt;span style="color:#e6db74">/.oh-my-zsh&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ZSH_THEME&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;cloud&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># zsh-nvm and zsh-autosuggestions must be installed separately&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>plugins&lt;span style="color:#f92672">=(&lt;/span>git zsh-nvm zsh-autosuggestions&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>source $ZSH/oh-my-zsh.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="step-4-add-a-shell-script-to-load-your-dotfiles">Step 4. Add a shell script to load your dotfiles&lt;/h3>
&lt;p>Now if our &amp;ldquo;.zshrc&amp;rdquo; file wasn&amp;rsquo;t trying to load plugins that don&amp;rsquo;t exist, we could just use it as is. As long as it&amp;rsquo;s in the root of the repo, Codespaces will copy this (and any other dotfile) to the $HOME directory in your Codespace. Which is where you want them. But we threw some chaos into the situation by including plugins that need to be installed separately, and I did that so we can examine what happens when you need to run a script to properly &amp;ldquo;install&amp;rdquo; your dotfiles - which is frequently the case because you&amp;rsquo;ll end up trying to do all manner of crazy things to your Codespace and by God, I want you to realize all your hopes and dreams.&lt;/p>
&lt;p>You can add a script file to your dotfiles repo that will be executed when the dotfiles are loaded into your Codespaces. You do have to give it the proper name, but GitHub gives you &lt;a href="https://docs.github.com/en/codespaces/customizing-your-codespace/personalizing-codespaces-for-your-account#dotfiles">several to choose from&lt;/a>. For this example, we&amp;rsquo;ll just use &lt;code>install.sh&lt;/code>. When Codespaces detects a script file in your dotfiles repo, it clones the dotfiles repo to &amp;ldquo;/workspaces/.codespaces/.persistedshare/dotfiles&amp;rdquo; and then executes your script file. It expects your script file to do all of the copying of dotfiles to the correct place.&lt;/p>
&lt;p>In the script file, you&amp;rsquo;ll need to first make it executable by adding &lt;code>#!/bin/bash&lt;/code>. Not all Linux distros include &amp;ldquo;bash&amp;rdquo;, so if &amp;ldquo;bash&amp;rdquo; isn&amp;rsquo;t present in your Codespace, you can use &lt;code>#!/bin/sh&lt;/code>.&lt;/p>
&lt;p>I like to wrap up all my logic in a function and call that function. This script file is only handling the &amp;ldquo;.zshrc&amp;rdquo;, but it could handle all sorts of other dotfiles install logic in the future, so having separate functions will make me look like a &amp;ldquo;real&amp;rdquo; developer. In this function, we&amp;rsquo;re going to install the 2 plugins: zsh-autosuggestions and zsh-nvm.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#!/bin/sh
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>zshrc&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> echo &lt;span style="color:#e6db74">&amp;#34;===========================================================&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> echo &lt;span style="color:#e6db74">&amp;#34; cloning zsh-autosuggestions &amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> echo &lt;span style="color:#e6db74">&amp;#34;-----------------------------------------------------------&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> git clone https://github.com/zsh-users/zsh-autosuggestions &lt;span style="color:#e6db74">${&lt;/span>ZSH_CUSTOM&lt;span style="color:#66d9ef">:-&lt;/span>~/.oh-my-zsh/custom&lt;span style="color:#e6db74">}&lt;/span>/plugins/zsh-autosuggestions
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> echo &lt;span style="color:#e6db74">&amp;#34;===========================================================&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> echo &lt;span style="color:#e6db74">&amp;#34; cloning zsh-zsh-nvm &amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> echo &lt;span style="color:#e6db74">&amp;#34;-----------------------------------------------------------&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> git clone https://github.com/lukechilds/zsh-nvm &lt;span style="color:#e6db74">${&lt;/span>ZSH_CUSTOM&lt;span style="color:#66d9ef">:-&lt;/span>~/.oh-my-zsh/custom&lt;span style="color:#e6db74">}&lt;/span>/plugins/zsh-nvm
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> echo &lt;span style="color:#e6db74">&amp;#34;===========================================================&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> echo &lt;span style="color:#e6db74">&amp;#34; Import zshrc &amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> echo &lt;span style="color:#e6db74">&amp;#34;-----------------------------------------------------------&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cat .zshrc &amp;gt; $HOME/.zshrc
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>zshrc
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&amp;ldquo;Adding&amp;rdquo; these plugins is just cloning them into the custom plugins directory. Just pay attention to the destination and make sure you are using the ZSH_CUSTOM variable so they end up in the right place.&lt;/p>
&lt;p>The last thing we do in that script is overwrite the &amp;ldquo;.zshrc&amp;rdquo; file in the HOME directory with the contents of the one from our dotfiles repo. Remember, when when Codespaces detects a script file in your dotfiles repo, it copies the whole thing to &amp;ldquo;/workspaces/.codespaces/.persistedshare/dotfiles&amp;rdquo;. So it&amp;rsquo;s on YOU to copy those dotfiles to the right place with your script file.&lt;/p>
&lt;h3 id="step-5-mark-the-install-script-as-executable-with-git">Step 5. Mark the install script as executable with git&lt;/h3>
&lt;p>Now you need to tell &lt;em>git&lt;/em> that this file is executable. I figured this out just last week after getting &amp;ldquo;file is not executable&amp;rdquo; over and over and Googling my fingers off. You need to &lt;em>git add&lt;/em> the &amp;ldquo;install.sh&amp;rdquo; as executable. If you&amp;rsquo;ve already added it, remove it with &lt;code>git rm --cached install.sh&lt;/code>.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>git add install.sh --chmod&lt;span style="color:#f92672">=&lt;/span>+x
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>You can also mark the file as executable with &lt;code>git update-index --chmod=+x install.sh&lt;/code>, but if you do that, every time you change the script file the executable bit will get flipped off and you&amp;rsquo;ll have to run that command again and you will forget and get stuck in a cycle of &amp;ldquo;file is not executable&amp;rdquo; and you will subconsciously blame me and I don&amp;rsquo;t need that on my conscience.&lt;/p>
&lt;blockquote>
&lt;p>NOTE: After you add the install.sh with the +x (executable) bit turned on and commit, git may still show that install.sh file as having changes. Reject those changes because you&amp;rsquo;ll just be flipping the bit back. It&amp;rsquo;s tedious. I know.&lt;/p>
&lt;/blockquote>
&lt;p>Now commit all your files and push them to your repo.&lt;/p>
&lt;h2 id="step-5-link-your-dotfiles-repo-to-codespaces">Step 5: Link your dotfiles repo to Codespaces&lt;/h2>
&lt;p>Navigate to &lt;a href="https://github.com/settings/codespaces">https://github.com/settings/codespaces&lt;/a> and select your dotfiles repo at the top. This will link your dotfiles repo to any new Codespace that you have.&lt;/p>
&lt;p>&lt;img src="https://burkeholland.github.io/media/codespaces-dotfiles.png" alt="dotfiles configuration screen in Codespaces">&lt;/p>
&lt;p>If you already have a Codespace, doing a rebuild should pull in your dotfiles. If you change your dotfiles, rebuilding your Codespace will pull in those changes as well.&lt;/p>
&lt;h2 id="step-6-make-sure-the-right-shell-is-being-loaded">Step 6: Make sure the right shell is being loaded&lt;/h2>
&lt;p>By default, Codespaces load &amp;ldquo;oh-my-bash&amp;rdquo;, which is kind of like &amp;ldquo;oh-my-zsh&amp;rdquo;, but not at all &amp;ldquo;oh-my-zsh&amp;rdquo;. You need to tell your Codespace to load zsh as your terminal. Thanks to &lt;a href="https://twitter.com/brettsky">@brettsky on Twitter&lt;/a> for pointing out that the easiest way to that is to add the following to your VS Code settings (&lt;kbd>Cmd/Ctrl&lt;/kbd> + &lt;kbd>,&lt;/kbd>)&amp;hellip;&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#34;terminal.integrated.defaultProfile.linux&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;zsh&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;p>If you don&amp;rsquo;t do this, your zsh shell just won&amp;rsquo;t be loaded and it will look like your dotfiles are doing nothing.&lt;/p>
&lt;/blockquote>
&lt;h3 id="making-it-work-with-remote-containers">Making it work with Remote-Containers&lt;/h3>
&lt;p>The &lt;a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-containers&amp;amp;WT.mc_id=devcloud-0000-buhollan">Remote-Containers extension for VS Code&lt;/a> uses virtually the same technology and configuration as Codespaces. With Remote-Containers, you are essentially hosting your own Codespace. With Remote-Containers, you can still use this exact same setup, but you need to change one setting in VS Code to tell Remote-Containers where your dotfiles repo is&amp;hellip;&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#34;dotfiles.repository&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;https://github.com/burkeholland/dotfiles&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="take-your-custom-environment-with-you">Take your custom environment with you&lt;/h2>
&lt;p>Having your dotfiles automatically installed basically lets you configure every Codespace automatically so you always get the environment that you know and love. It&amp;rsquo;s also only specific to you, so someone who forks your repo won&amp;rsquo;t get your terminal. Even though they would be better off if they did and we both know it.&lt;/p></description></item><item><title>Converting Cosmos DB Timestamps to JavaScript Dates</title><link>https://burkeholland.github.io/posts/azure/azurecosmosdb-dates/</link><pubDate>Thu, 05 Aug 2021 10:34:40 -0500</pubDate><guid>https://burkeholland.github.io/posts/azure/azurecosmosdb-dates/</guid><description>&lt;p>Cosmos DB automactially adds a timestamp field called &amp;ldquo;_ts&amp;rdquo;. everytime a document is &lt;strong>created&lt;/strong> or &lt;strong>updated&lt;/strong>. And it looks like this&amp;hellip;&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;_ts&amp;#34;&lt;/span>: &lt;span style="color:#ae81ff">1628083065&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>That number is described by &lt;a href="https://devblogs.microsoft.com/cosmosdb/new-date-and-time-system-functions/?WT.mc_id=devcloud-0000-buhollan#converting-the-system-_ts-property-to-a-datetime-string">this blog post&lt;/a> as an &amp;ldquo;epoch value in seconds (not milliseconds) since an item was last modified.&amp;rdquo; The number of seconds since what? Well, the number of seconds since January 1st, 1970 to be exact. This is a Unix date format (aslo called &amp;ldquo;epoch&amp;rdquo;) and you can use JavaScript to convert that into a date object that you can actually use.&lt;/p>
&lt;h2 id="converting-javascript-date">Converting JavaScript Date&lt;/h2>
&lt;p>You can create a JavaScript Date object from an epoch value by just passing the value to the Date constructor. HOWEVER; the &lt;a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/Date">docs for the JavaScript Date object&lt;/a> say that &amp;ldquo;Date objects contain a number that respresents the number of &lt;em>milliseconds&lt;/em> since January 1, 1970.&amp;rdquo; By contrast, the Cosmos DB &lt;code>_ts&lt;/code> property is the number of &lt;em>seconds&lt;/em> since January 1, 1970. So in order to get the correct time, we have to multiply the _ts value by 1000 so that it&amp;rsquo;s milliseconds instead of seconds. So the final answer looks like this&amp;hellip;&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">d&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> Date(&lt;span style="color:#a6e22e">_ts&lt;/span> &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#ae81ff">1000&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#a6e22e">d&lt;/span>.&lt;span style="color:#a6e22e">toDateString&lt;/span>());
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// OUPTUT: &amp;#39;Wed Aug 04 2021&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Upload an Image to Azure Storage with Static Web Apps</title><link>https://burkeholland.github.io/posts/azure/upload-image-swa/</link><pubDate>Sat, 31 Jul 2021 09:30:16 -0500</pubDate><guid>https://burkeholland.github.io/posts/azure/upload-image-swa/</guid><description>&lt;p>One of the great advantages to &lt;a href="https://docs.microsoft.com/azure/static-web-apps/?WT.mc_id=devcloud-0000-buhollan">Azure Static Web Apps&lt;/a> &lt;em>should be&lt;/em> the ability to easily integrate with other Azure services. I&amp;rsquo;ve been working on a &lt;a href="https://github.com/burkeholland/fresh-blog">sample blog project&lt;/a> a la the old Ruby on Rails tutorial, and I wanted to add the ability to upload an image to a blog.&lt;/p>
&lt;p>&lt;img src="https://burkeholland.github.io/media/azure/upload-image-swa/lego-shoe.gif" alt="">&lt;/p>
&lt;p>Now, there are two ways to go about this. You can do it from the client, or you can do it from the server.&lt;/p>
&lt;h3 id="client-side-upload-i-dont-like">Client-side upload (I Don&amp;rsquo;t Like)&lt;/h3>
&lt;p>In a client-side upload, you need to create a function in your static web app API that returns something called an SASToken, which is a temporary key that allows someone to upload an image. You then put all the upload code in your frontend application and upload the image directly to Azure Storage using that temporary key.&lt;/p>
&lt;p>This was the strategy that we used in the Sunrise Standup demo. You can see the code to generate the SASToken &lt;a href="https://github.com/sunrise-standup/sunrise-standup/blob/main/api/GetSASToken/index.js">here&lt;/a>, and the code to get that token and upload the image &lt;a href="https://github.com/sunrise-standup/sunrise-standup/blob/main/src/api/storageApi.js">here&lt;/a>. The thing that should jump out at you right away is that it is a &lt;strong>lot&lt;/strong> of code. It feels heavy for something that should be rather simple - especially from one Azure service to another. I felt at one point like I was trying to do OAuth and that&amp;rsquo;s just not a feeling anyone wants to have.&lt;/p>
&lt;h3 id="server-side-upload-i-like">Server-side upload (I Like)&lt;/h3>
&lt;p>In a server-side upload, you upload your image to your static web app API, and let the API handle the upload to storage. The reason I like this is that it&amp;rsquo;s &lt;strong>far less code&lt;/strong>. It also centralizes the logic instead of spreading it between the frontend and API.&lt;/p>
&lt;p>Let&amp;rsquo;s talk about the client-side first. To upload an image to a static web app API (which is just an Azure Function), you need to post it as &lt;code>FormData&lt;/code>. It looks like this&amp;hellip;&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">async&lt;/span> &lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">handleFileUpload&lt;/span>(&lt;span style="color:#a6e22e">image&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// create a new form data object that will hold the image
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">let&lt;/span> &lt;span style="color:#a6e22e">formData&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">FormData&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">formData&lt;/span>.&lt;span style="color:#a6e22e">append&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;file_upload&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">image&lt;/span>, &lt;span style="color:#a6e22e">image&lt;/span>.&lt;span style="color:#a6e22e">name&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// send the form data object to the server (uploads file)
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">response&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">fetch&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;api/upload&amp;#34;&lt;/span>, {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">method&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;POST&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">body&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">formData&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">json&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">response&lt;/span>.&lt;span style="color:#a6e22e">json&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">json&lt;/span>.&lt;span style="color:#a6e22e">imageUrl&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>This is pretty simple. Create a FormData object, append the image as data and then pass that form data object on the post request. It takes a bit of knowing about how to post form data, but if you don&amp;rsquo;t know, now you know.&lt;/p>
&lt;p>The second part is to create the function that will handle the &amp;ldquo;api/upload&amp;rdquo; request. This is the beefy part because it&amp;rsquo;s doing all the work.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-typescript" data-lang="typescript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">import&lt;/span> { &lt;span style="color:#a6e22e">AzureFunction&lt;/span>, &lt;span style="color:#a6e22e">Context&lt;/span>, &lt;span style="color:#a6e22e">HttpRequest&lt;/span> } &lt;span style="color:#66d9ef">from&lt;/span> &lt;span style="color:#e6db74">&amp;#34;@azure/functions&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">import&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">BlobServiceClient&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">StorageSharedKeyCredential&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">newPipeline&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>} &lt;span style="color:#66d9ef">from&lt;/span> &lt;span style="color:#e6db74">&amp;#34;@azure/storage-blob&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">import&lt;/span> &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#66d9ef">as&lt;/span> &lt;span style="color:#a6e22e">streamifier&lt;/span> &lt;span style="color:#66d9ef">from&lt;/span> &lt;span style="color:#e6db74">&amp;#34;streamifier&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">import&lt;/span> &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#66d9ef">as&lt;/span> &lt;span style="color:#a6e22e">multipart&lt;/span> &lt;span style="color:#66d9ef">from&lt;/span> &lt;span style="color:#e6db74">&amp;#34;parse-multipart&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">STORAGE_ACCOUNT&lt;/span>: &lt;span style="color:#66d9ef">string&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">process&lt;/span>.&lt;span style="color:#a6e22e">env&lt;/span>.&lt;span style="color:#a6e22e">STORAGE_ACCOUNT&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">STORAGE_KEY&lt;/span>: &lt;span style="color:#66d9ef">string&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">process&lt;/span>.&lt;span style="color:#a6e22e">env&lt;/span>.&lt;span style="color:#a6e22e">STORAGE_KEY&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">STORAGE_CONTAINER&lt;/span>: &lt;span style="color:#66d9ef">string&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">process&lt;/span>.&lt;span style="color:#a6e22e">env&lt;/span>.&lt;span style="color:#a6e22e">STORAGE_CONTAINER&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">STORAGE_URL&lt;/span>: &lt;span style="color:#66d9ef">string&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">`https://&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>&lt;span style="color:#a6e22e">STORAGE_ACCOUNT&lt;/span>&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">.blob.core.windows.net`&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">httpTrigger&lt;/span>: &lt;span style="color:#66d9ef">AzureFunction&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">async&lt;/span> &lt;span style="color:#66d9ef">function&lt;/span> (
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">context&lt;/span>: &lt;span style="color:#66d9ef">Context&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">req&lt;/span>: &lt;span style="color:#66d9ef">HttpRequest&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>)&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">Promise&lt;/span>&amp;lt;&lt;span style="color:#f92672">void&lt;/span>&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// Get the image data from the request
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">bodyBuffer&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">Buffer&lt;/span>.&lt;span style="color:#66d9ef">from&lt;/span>(&lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">body&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// use the parse-multipart library to parse the multipart form data
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">boundary&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">multipart&lt;/span>.&lt;span style="color:#a6e22e">getBoundary&lt;/span>(&lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">headers&lt;/span>[&lt;span style="color:#e6db74">&amp;#34;content-type&amp;#34;&lt;/span>]);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">parts&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">multipart&lt;/span>.&lt;span style="color:#a6e22e">Parse&lt;/span>(&lt;span style="color:#a6e22e">bodyBuffer&lt;/span>, &lt;span style="color:#a6e22e">boundary&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">fileData&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">parts&lt;/span>[&lt;span style="color:#ae81ff">0&lt;/span>].&lt;span style="color:#a6e22e">data&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// Append a date string to the front to make every file name unique
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">fileName&lt;/span> &lt;span style="color:#f92672">=&lt;/span> Date.&lt;span style="color:#a6e22e">now&lt;/span>() &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#a6e22e">parts&lt;/span>[&lt;span style="color:#ae81ff">0&lt;/span>].&lt;span style="color:#a6e22e">filename&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">contentType&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">parts&lt;/span>[&lt;span style="color:#ae81ff">0&lt;/span>].&lt;span style="color:#66d9ef">type&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// Set auth credentials for upload
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">sharedKeyCredential&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">StorageSharedKeyCredential&lt;/span>(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">STORAGE_ACCOUNT&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">STORAGE_KEY&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> );
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">pipeline&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">newPipeline&lt;/span>(&lt;span style="color:#a6e22e">sharedKeyCredential&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// Upload the file
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">blobServiceClient&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">BlobServiceClient&lt;/span>(&lt;span style="color:#a6e22e">STORAGE_URL&lt;/span>, &lt;span style="color:#a6e22e">pipeline&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">containerClient&lt;/span> &lt;span style="color:#f92672">=&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">blobServiceClient&lt;/span>.&lt;span style="color:#a6e22e">getContainerClient&lt;/span>(&lt;span style="color:#a6e22e">STORAGE_CONTAINER&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">blockBlobClient&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">containerClient&lt;/span>.&lt;span style="color:#a6e22e">getBlockBlobClient&lt;/span>(&lt;span style="color:#a6e22e">fileName&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">uploadBlobResopnse&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">blockBlobClient&lt;/span>.&lt;span style="color:#a6e22e">uploadStream&lt;/span>(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">streamifier&lt;/span>.&lt;span style="color:#a6e22e">createReadStream&lt;/span>(&lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">Buffer&lt;/span>(&lt;span style="color:#a6e22e">fileData&lt;/span>)),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">fileData&lt;/span>.&lt;span style="color:#a6e22e">length&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">5&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">blobHTTPHeaders&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">blobContentType&lt;/span>: &lt;span style="color:#66d9ef">contentType&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> );
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">context&lt;/span>.&lt;span style="color:#a6e22e">res&lt;/span> &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">body&lt;/span>&lt;span style="color:#f92672">:&lt;/span> { &lt;span style="color:#a6e22e">imageUrl&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">`&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>&lt;span style="color:#a6e22e">STORAGE_URL&lt;/span>&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">/&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>&lt;span style="color:#a6e22e">STORAGE_CONTAINER&lt;/span>&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">/&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>&lt;span style="color:#a6e22e">fileName&lt;/span>&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">`&lt;/span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> };
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">export&lt;/span> &lt;span style="color:#66d9ef">default&lt;/span> &lt;span style="color:#a6e22e">httpTrigger&lt;/span>;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Let&amp;rsquo;s walk through what&amp;rsquo;s going on here piece by piece&amp;hellip;&lt;/p>
&lt;ol>
&lt;li>The binary data comes into the function as &amp;ldquo;multipart/form-data&amp;rdquo; because remember - we used the &lt;code>FormData&lt;/code> object on the client, so you need to parse it as such. You can use the &lt;a href="https://www.npmjs.com/package/parse-multipart">parse-multipart&lt;/a> node package to do this.&lt;/li>
&lt;li>The form data comes in as binary, so you need to read it into a &lt;code>Buffer&lt;/code> object so you can work with.&lt;/li>
&lt;li>The request header contains the &amp;ldquo;boundary&amp;rdquo; for the data - or where the data ends. Once you know the boundary, you can pass that to the multipart library and it will parse out the form data.&lt;/li>
&lt;li>Once you&amp;rsquo;ve parsed the form data, you can read it and get the file name, type (jpg, png, ect), image data ect. You&amp;rsquo;ll get an array object when you parse the form data in case you uploaded multiple images so a single image will be at position 0.&lt;/li>
&lt;li>Next you setup the shared access key for your storage account. Your key can be securely held in the API &lt;code>local.settings.json&lt;/code> file.&lt;/li>
&lt;li>Last, you upload the file as a stream. To do that, you want to use the &lt;a href="https://www.npmjs.com/package/streamifier">streamifier&lt;/a> Node package.
&lt;ol>
&lt;li>An important note here is that you set the &lt;code>blobHTTPHeaders&lt;/code> and the &lt;code>blobContentType&lt;/code> so that your image is uploaded as an image. Otherwise it&amp;rsquo;s uploaded as blob data and when you try to access it via your browser, your browser will download it instead of just displaying it.&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ol>
&lt;h2 id="bro-thats-still-a-lot-of-code">BRO THAT&amp;rsquo;S STILL A LOT OF CODE&lt;/h2>
&lt;p>I know. I put the upload logic in a service.ts so that my API function just looks like this&amp;hellip;&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-typescript" data-lang="typescript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">import&lt;/span> { &lt;span style="color:#a6e22e">AzureFunction&lt;/span>, &lt;span style="color:#a6e22e">Context&lt;/span>, &lt;span style="color:#a6e22e">HttpRequest&lt;/span> } &lt;span style="color:#66d9ef">from&lt;/span> &lt;span style="color:#e6db74">&amp;#34;@azure/functions&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">import&lt;/span> &lt;span style="color:#a6e22e">storageService&lt;/span> &lt;span style="color:#66d9ef">from&lt;/span> &lt;span style="color:#e6db74">&amp;#34;../services/storageService&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">httpTrigger&lt;/span>: &lt;span style="color:#66d9ef">AzureFunction&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">async&lt;/span> &lt;span style="color:#66d9ef">function&lt;/span> (
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">context&lt;/span>: &lt;span style="color:#66d9ef">Context&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">req&lt;/span>: &lt;span style="color:#66d9ef">HttpRequest&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>)&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">Promise&lt;/span>&amp;lt;&lt;span style="color:#f92672">void&lt;/span>&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">imageUrl&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">storageService&lt;/span>.&lt;span style="color:#a6e22e">upload&lt;/span>(&lt;span style="color:#a6e22e">req&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">context&lt;/span>.&lt;span style="color:#a6e22e">res&lt;/span> &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">body&lt;/span>&lt;span style="color:#f92672">:&lt;/span> { &lt;span style="color:#a6e22e">imageUrl&lt;/span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> };
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">export&lt;/span> &lt;span style="color:#66d9ef">default&lt;/span> &lt;span style="color:#a6e22e">httpTrigger&lt;/span>;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="security">SECURITY!&lt;/h2>
&lt;p>This is where we take advantage of the &lt;a href="https://docs.microsoft.com/azure/static-web-apps/configuration?WT.mc_id=devcloud-0000-buhollan#example-configuration-file">built-in security in static web apps&lt;/a> and use a &lt;code>staticwebapp.config.json&lt;/code> file to say that if you&amp;rsquo;re not logged in and in the right role, you can&amp;rsquo;t call this endpoint. In fact, I lock down every HTTP verb that might modify something under one rule.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;routes&amp;#34;&lt;/span>: [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;route&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;/api/*&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;methods&amp;#34;&lt;/span>: [&lt;span style="color:#e6db74">&amp;#34;PUT&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;POST&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;PATCH&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;DELETE&amp;#34;&lt;/span>],
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;allowedRoles&amp;#34;&lt;/span>: [&lt;span style="color:#e6db74">&amp;#34;author&amp;#34;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="possible-drawbacks">Possible Drawbacks&lt;/h2>
&lt;p>The only drawback I can think of to this method is that you are technically uploading the image &lt;em>twice&lt;/em>; once to the API and then once to Azure Storage. So if you had a large image, it &lt;em>could&lt;/em> be slower. But remember, static web app APIs are Azure Functions, which are already in Azure. So when you upload the image, it&amp;rsquo;s already there. You&amp;rsquo;re just transfering it over to storage. Transfering data within Azure is 1) FAST and 2) FREE. That last one being the most important.&lt;/p>
&lt;h2 id="its-still-harder-than-it-should-be">It&amp;rsquo;s still harder than it should be&lt;/h2>
&lt;p>I agree. I would like to see some integration down the road where we provide you with a client-side API that will let you upload to storage and handle all of the key business for you. Perhaps we just light up and endpoint like &amp;ldquo;/.storage&amp;rdquo;. I don&amp;rsquo;t know. I&amp;rsquo;m not on the engineering team and you should be thankful for that otherwise you&amp;rsquo;d end up with features like the one I just suggested which now that I&amp;rsquo;ve typed it looks rediculous.&lt;/p>
&lt;p>But you get the idea. In the meantime, I hope this helps. Happy uploading.&lt;/p></description></item><item><title>How to use 'Dark Mode' in VS Code</title><link>https://burkeholland.github.io/posts/vscode/dark-mode-theme/</link><pubDate>Sat, 27 Feb 2021 09:08:40 -0600</pubDate><guid>https://burkeholland.github.io/posts/vscode/dark-mode-theme/</guid><description>&lt;p>After my post on &lt;a href="http://localhost:1313/posts/vscode/auto-switch-themes/">how to auto-switch your theme based on the time of day&lt;/a>, a few readers pointed out that VS Code &amp;ldquo;does this automatically&amp;rdquo;. In other words, you don&amp;rsquo;t need the extension that I recommended to do this.&lt;/p>
&lt;p>I had no idea! Is this true? Kind of&amp;hellip;&lt;/p>
&lt;p>While VS Code doesn&amp;rsquo;t have built-in ability to change your theme based on the time of day, it &lt;strong>does&lt;/strong> have the ability to change your theme based on whether or not you are using &amp;ldquo;Dark Mode&amp;rdquo; in your Operating System. This is done via the &lt;code>workbench.prefferedLightTheme&lt;/code> and &lt;code>workbench.preferredDarkColorTheme&lt;/code> settings. You must use these in conjunction with the &lt;code>autoDetectColorScheme&lt;/code> setting in order for them to have any effect.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#34;window.autoDetectColorScheme&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">:&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#34;workbench.preferredDarkColorTheme&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;GitHub Dark&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#34;workbench.preferredLightColorTheme&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;GitHub Light&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>By the way, I think the &lt;a href="https://marketplace.visualstudio.com/items?itemName=GitHub.github-vscode-theme&amp;amp;WT.mc_id=devcloud-18058-buhollan">GitHub themes&lt;/a> are the most underrated VS Code themes out there. Both the Light and the Dark are clean, sharp and Burke approved. Highly &lt;a href="https://marketplace.visualstudio.com/items?itemName=GitHub.github-vscode-theme&amp;amp;WT.mc_id=devcloud-18058-buhollan">recommended&lt;/a>.&lt;/p>
&lt;p>&lt;img src="https://burkeholland.github.io/media/dark-mode-theme/github-theme.png" alt="">&lt;/p>
&lt;p>Now this doesn&amp;rsquo;t really solve the issue I was trying to tackle in the previous blog post about switching themes based on time of day, but it &lt;em>can&lt;/em>.&lt;/p>
&lt;h2 id="switch-to-dark-mode-based-on-time-of-day">Switch to Dark Mode based on time of day&lt;/h2>
&lt;p>You can switch your entire operating system to Dark Mode based on the time of day. Dark Mode at night and Light Mode during the day. Or vice-versa if you think &lt;a href="https://www.youtube.com/watch?v=qXZM5bxoccc">society is a platypus&lt;/a>.&lt;/p>
&lt;h3 id="for-macos">For macOS&lt;/h3>
&lt;p>If you&amp;rsquo;re on a Mac, this is built-in as of Catalina. There is an &amp;ldquo;Auto&amp;rdquo; setting when you choose between Light and Dark mode. This will switch you to dark mode with the sun goes down, and back to light when it comes back up. Unfortunately, Apple will decide that for you because let&amp;rsquo;s be honest - they know what&amp;rsquo;s best for you. Stop trying to live your life your way.&lt;/p>
&lt;p>If you want to control the exact time when this happens, you can use the &lt;a href="https://nightowl.kramser.xyz/#">NightOwl&lt;/a> app.&lt;/p>
&lt;h3 id="for-windows">For Windows&lt;/h3>
&lt;p>This is not yet built-in to Windows, but you can either &lt;a href="https://www.howtogeek.com/356087/how-to-automatically-enable-windows-10s-dark-theme-at-night/">setup a scheduled task to do it&lt;/a>, or consider installing the &lt;a href="https://github.com/Armin2208/Windows-Auto-Night-Mode">Windows Auto Night Mode&lt;/a> program.&lt;/p>
&lt;p>I opted for the scheduled task as I&amp;rsquo;m not big into installing unsigned .exe&amp;rsquo;s - even though that one looks legit.&lt;/p>
&lt;p>Now VS Code will automatically switch color themes based on the time of day, and you don&amp;rsquo;t need any extensions to do it.&lt;/p>
&lt;p>I&amp;rsquo;ve been using it for about a week now and&amp;hellip;&lt;/p>
&lt;h2 id="im-going-back-to-the-extension">I&amp;rsquo;m going back to the extension&lt;/h2>
&lt;p>I just don&amp;rsquo;t like Dark Mode. It&amp;rsquo;s one thing to have a dark VS Code theme. It&amp;rsquo;s quite another to have it applied to the entire OS. I have trouble reading web pages and discerning parts of the screen. I&amp;rsquo;ll stick with switching the theme in VS Code and leave Windows alone.&lt;/p>
&lt;p>I know we&amp;rsquo;re all supposed to love Dark Mode these days, but I just can&amp;rsquo;t get into it. But let this blog post stand as the record that I did try.&lt;/p></description></item><item><title>Google trends shows Python interest surging</title><link>https://burkeholland.github.io/posts/python-interest-surging/</link><pubDate>Mon, 22 Feb 2021 10:03:14 -0600</pubDate><guid>https://burkeholland.github.io/posts/python-interest-surging/</guid><description>&lt;p>While looking at Google Trends the other day for &lt;a href="https://trends.google.com/trends/explore?q=visual%20studio%20code&amp;amp;geo=US">&amp;ldquo;visual studio code&amp;rdquo;&lt;/a>, I noticed that one of the rising trends was &amp;ldquo;visual studio code format json&amp;rdquo;. Today, it&amp;rsquo;s gone, but still in the top related queries along with &amp;ldquo;how to format code&amp;rdquo;.&lt;/p>
&lt;p>This got me curious as to what it is that people search for the most along with &amp;ldquo;visual studio code&amp;rdquo; or &amp;ldquo;vs code&amp;rdquo; in the last 12 months.&lt;/p>
&lt;h2 id="top-related-searches">Top Related Searches&lt;/h2>
&lt;p>It varries slightly depending on whether you search for &amp;ldquo;visual studio code&amp;rdquo; or &amp;ldquo;vs code&amp;rdquo;, but not nearly as much as you might think&amp;hellip;&lt;/p>
&lt;h3 id="visual-studio-code">&amp;ldquo;visual studio code&amp;rdquo;&lt;/h3>
&lt;ol>
&lt;li>visual studio vs visual studio code&lt;/li>
&lt;li>vs code&lt;/li>
&lt;li>vs code vs visual studio&lt;/li>
&lt;li>download visual studio code&lt;/li>
&lt;li>visual studio code python&lt;/li>
&lt;/ol>
&lt;h3 id="vs-code">&amp;ldquo;vs code&amp;rdquo;&lt;/h3>
&lt;ol>
&lt;li>vs code vs visual studio&lt;/li>
&lt;li>visual studio code vs visual studio&lt;/li>
&lt;li>visual studio&lt;/li>
&lt;li>visual studio code&lt;/li>
&lt;li>python&lt;/li>
&lt;/ol>
&lt;p>In both cases, what struck me is that Python shows up in the top 5. What&amp;rsquo;s even more interesting is that if you expand the time range to 2 years, Python drops off the list completely. So in the past 12 months, Python has gone from &amp;ldquo;not on the list&amp;rdquo; to &amp;ldquo;in the top 5&amp;rdquo;. That&amp;rsquo;s quite the movement.&lt;/p>
&lt;h3 id="why-python">Why Python?&lt;/h3>
&lt;p>One of the reasons could be the overall meteoric rise of Python. In December, Stack Overflow reported that it was the &lt;a href="https://insights.stackoverflow.com/survey/2020#most-popular-technologies">4th most popular technology&lt;/a> on their site, beating out Java by 4 percentage points. This was &lt;a href="https://insights.stackoverflow.com/survey/2019#technology">also true in 2019&lt;/a>, but only by a razor thin margin when compared to Java. In 2018, &lt;a href="https://insights.stackoverflow.com/survey/2018#technology">it was number 7&lt;/a> overall with Java enjoying a 7 point lead.&lt;/p>
&lt;p>Stack Overflow is only one measurement and certainly pulls only from the &amp;ldquo;Stack Overflow&amp;rdquo; demographic. The TIOBE index attempts to rate based on an aggregation of the &amp;ldquo;number of skilled engineers world-wide, courses and third party vendors.&amp;rdquo; According to &lt;a href="https://www.tiobe.com/tiobe-index/">TIOBE&amp;rsquo;s February 2021 numbers&lt;/a>, Python is number 3, beaten only Java with the leader being C? Which, I was onboard until &amp;ldquo;C&amp;rdquo;. That seems hard to believe.&lt;/p>
&lt;p>So Python is popular, but why is &lt;em>that&lt;/em>?&lt;/p>
&lt;p>There are a lot of potential reasons. Certainly one is that Python is a popular language for students.&lt;/p>
&lt;p>This is because it&amp;rsquo;s syntatically easier to write than it&amp;rsquo;s C-based counterparts. It is also dynamic, which means that it doesn&amp;rsquo;t require a compilation step. And possibly most important of all - it skirts around the painfully abstract &amp;ldquo;object-oriented&amp;rdquo; programming model. I spent far more &lt;strong>time&lt;/strong> trying to understand classes and inheritance than I ever did using them.&lt;/p>
&lt;p>There is also the rise in popularity of data science as a profession. Although I remain skeptical of this. I still don&amp;rsquo;t know anyone who works as a &amp;ldquo;data scientist&amp;rdquo;. I&amp;rsquo;m not saying the job doesn&amp;rsquo;t exist - I know that it does. And a lot of other people must expect that it does too, because &amp;ldquo;Data scientist or machine learning specialist&amp;rdquo; is the &lt;a href="https://insights.stackoverflow.com/survey/2020#work-whos-actively-looking-for-a-job">#2 on people &amp;ldquo;actively looking for a job&amp;rdquo;&lt;/a> on the same Stack Overflow survey I referenced earlier. But it only occupies &lt;a href="https://insights.stackoverflow.com/survey/2020#developer-roles">8% of the total available roles&lt;/a>. I&amp;rsquo;m just saying that perhaps the hype is a lot bigger than the demand.&lt;/p>
&lt;h2 id="python-is-big">Python is big&lt;/h2>
&lt;p>All arguments on what people are doing with Python aside, it&amp;rsquo;s certainly popular even by Google Trends standards - even when you &lt;em>aren&amp;rsquo;t&lt;/em> searching for it. That&amp;rsquo;s a measurement that is quite hard to deny. So if you are looking to do Python with Visual Studio Code, here is a list of resources that I hope you find helpful&amp;hellip;&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;a href="https://code.visualstudio.com/learntocode?WT.mc_id=devcloud-17278-buhollan">Python Coding Pack&lt;/a> - A complete install of VS Code that also installs Python, the Python extension and configures your enviornment. Recommended for folks who just want to get up and running with a single install.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://code.visualstudio.com/docs/python/python-tutorial?WT.mc_id=devcloud-17278-buhollan">Python in VS Code Tutorial&lt;/a> - Official VS Code docs on using Python in VS Code complete with &amp;ldquo;Hello World&amp;rdquo; tutorial.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://channel9.msdn.com/Series/Intro-to-Python-Development?WT.mc_id=python-c9-niner&amp;amp;WT.mc_id=devcloud-17278-buhollan">Python for Beginners Video Series&lt;/a> - Don&amp;rsquo;t know Python? No problem! This free video series starts from the beginning.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://marketplace.visualstudio.com/items?itemName=ms-python.python&amp;amp;WT.mc_id=devcloud-17278-buhollann">Python Extension for VS Code&lt;/a> - IntelliSense, linting, debugging, formatting AND support for Jupyter Notebooks&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://marketplace.visualstudio.com/items?itemName=ms-toolsai.jupyter&amp;amp;WT.mc_id=devcloud-17278-buhollan">Jupyter Notebooks Extension for VS Code&lt;/a> - Support for Jupyter Notebooks. This extension is included when you install the Python extension so you should do that instead.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://docs.microsoft.com/learn/modules/use-docker-container-dev-env-vs-code/?WT.mc_id=devcloud-17278-buhollan">Use a Docker Container as a Development Enviornment with VS Code&lt;/a> - How to spin up a Python dev env using a Docker container. All examples are in Python.&lt;/p>
&lt;/li>
&lt;/ul></description></item><item><title>How to switch themes in VS Code based on the time of day</title><link>https://burkeholland.github.io/posts/vscode/auto-switch-themes/</link><pubDate>Tue, 16 Feb 2021 13:53:57 -0600</pubDate><guid>https://burkeholland.github.io/posts/vscode/auto-switch-themes/</guid><description>&lt;p>It&amp;rsquo;s a good idea to switch between dark and light mode depending on what time of day it is. During the day when your body is more awake, it might make more sense to use a light theme where reading comprehension is better. At night, your eyes become more tired and bright screen light can be harder on your tired eyes.&lt;/p>
&lt;p>Visual Studio Code doesn&amp;rsquo;t do this out-of-the-box, but just like Steve Jobs once said, &amp;ldquo;There&amp;rsquo;s an extension for that&amp;rdquo;.&lt;/p>
&lt;h2 id="theme-switcher-extension">Theme Switcher Extension&lt;/h2>
&lt;p>The &lt;a href="https://marketplace.visualstudio.com/items?itemName=savioserra.theme-switcher&amp;amp;WT.mc_id=devcloud-8766-buhollan">Theme Switcher Extension&lt;/a> for VS Code will let you define times of the day at which to apply a different theme.&lt;/p>
&lt;p>&lt;img src="https://burkeholland.github.io/media/vscode/auto-switch-themes/theme-switcher-extension.jpg" alt="">&lt;/p>
&lt;p>Open the &lt;code>settings.json&lt;/code> file and add in the &lt;code>themeswitcher.mappings&lt;/code> property which takes an array of time and theme combinations. The theme will take affect at the designated time (24 hour format). Here&amp;rsquo;s mine&amp;hellip;&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#34;themeswitcher.mappings&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">:&lt;/span> [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;time&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;06:00&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;theme&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;GitHub Light&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;time&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;17:00&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;theme&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;GitHub Dark&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>]&lt;span style="color:#960050;background-color:#1e0010">,&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>You can have as many of these &amp;ldquo;change points&amp;rdquo; as you like. Change themes every hour if that makes you happy.&lt;/p>
&lt;p>Last, make sure you set the &amp;ldquo;utcOffset&amp;rdquo; property in &lt;code>settings.json&lt;/code> to account for your time zone. The extension doesn&amp;rsquo;t do that autmoatically. I&amp;rsquo;m Central Standard Time which is UTC - 6.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#34;themeswitcher.utcOffset&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">:&lt;/span> &lt;span style="color:#ae81ff">-6&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>You can find your UTC offset based on timezone &lt;a href="https://www.timeanddate.com/time/zones/">here&lt;/a>.&lt;/p>
&lt;p>Now VS Code will switch themes automatically based on the time of day. It&amp;rsquo;s not light theme vs dark theme, it&amp;rsquo;s enjoying the best of both worlds.&lt;/p></description></item><item><title>Beginner's series to Dev Containers free video course</title><link>https://burkeholland.github.io/posts/beginners-series-remote-containers/</link><pubDate>Thu, 11 Feb 2021 08:59:07 -0600</pubDate><guid>https://burkeholland.github.io/posts/beginners-series-remote-containers/</guid><description>&lt;figure class="quote">
&lt;blockquote>
"Knowledge isn't free. You have to pay attention."
&lt;/blockquote>
&lt;figcaption>
&amp;mdash; Richard Feynman
&lt;/figcaption>
&lt;/figure>
&lt;p>Ok, but all &amp;ldquo;play on words&amp;rdquo; aside, knowledge &lt;strong>is&lt;/strong> free. That&amp;rsquo;s the key contribution of the internet, isn&amp;rsquo;t it? That all knowledge is now essentially free? And this is kind of a recent development. It used to cost quite a bit to learn the skills that will make you successful. I mean, there is still a &lt;a href="https://nces.ed.gov/programs/coe/indicator_cud.asp#:~:text=In%202017%E2%80%9318%2C%20total%20revenues,at%20private%20for%2Dprofit%20institutions.">700 billion dollar industry&lt;/a> built on selling you knowledge.&lt;/p>
&lt;p>Even better, you can learn what you &lt;em>need&lt;/em> instead of things that you &lt;em>might&lt;/em> need. It&amp;rsquo;s been several decades and I have not once used &amp;ldquo;&lt;a href="https://www.khanacademy.org/math/algebra/x2f8bb11595b61c86:forms-of-linear-equations/x2f8bb11595b61c86:intro-to-slope-intercept-form/a/introduction-to-slope-intercept-form">Slope Intercept Form&lt;/a>&amp;rdquo;. NOT. ONCE. Well, that&amp;rsquo;s a lie, I had to use it to help my kid with his homework at which point I Googled it. Like an adult.&lt;/p>
&lt;p>But this post is not a shot at Algebra (I love you math people - really I do), this is about MORE free knowledge. Specficially, an 8 part video series on how to use &amp;ldquo;Development Containers&amp;rdquo;.&lt;/p>
&lt;blockquote>
&lt;p>If you prefer reading to videos (you do you) you can get this whole series as &lt;a href="https://docs.microsoft.com/en-us/learn/modules/use-docker-container-dev-env-vs-code?WT.mc_id=devcloud-11496-buhollan">step-by-step tutorial on Microsoft Learn&lt;/a>.&lt;/p>
&lt;/blockquote>
&lt;h2 id="development-containers">Development Containers&lt;/h2>
&lt;p>Development Containers (or Dev Containers) are just Docker containers. But we add a little &lt;a href="https://code.visualstudio.com/download?WT.mc_id=devcloud-11496-buhollan">VS Code&lt;/a> magic in the form of the &lt;a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-containers&amp;amp;WT.mc_id=devcloud-11496-buhollan">Remote - Containers extension&lt;/a> that allows you to develop &lt;em>inside&lt;/em> of the container right from the editor.&lt;/p>
&lt;p>Now why would you do this? Because once you define a container definition for a project, you can check it in to source as a config file. Then any developer could immediately spin up the right dev environment with &lt;em>zero&lt;/em> configuration. No Python install. No copy/paste cryptic terminal commands from Stack Overflow.&lt;/p>
&lt;p>So how does this work? I&amp;rsquo;m glad you asked! Or didn&amp;rsquo;t ask! Either way, queue up episode 1&amp;hellip;&lt;/p>
&lt;h3 id="episode-1">Episode 1:&lt;/h3>
&lt;p>Start your learning with developing in a Docker container in Visual Studio Code. Learn what it means to configure a container-based development environment, why you might want to develop in a container in VS Code, and what lies ahead in the rest of this video series.&lt;/p>
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe src="https://www.youtube.com/embed/61M2takIKl8" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video">&lt;/iframe>
&lt;/div>
&lt;h3 id="episode-2">Episode 2:&lt;/h3>
&lt;p>How to install the Remote - Containers extension in Visual Studio Code and see how it works.&lt;/p>
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe src="https://www.youtube.com/embed/ACIwcUXfNBI" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video">&lt;/iframe>
&lt;/div>
&lt;h3 id="episode-3">Episode 3:&lt;/h3>
&lt;p>How to add a dev container to your project in Visual Studio Code using the Remote - Containers extension.&lt;/p>
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe src="https://www.youtube.com/embed/yucjVHwFO0Y" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video">&lt;/iframe>
&lt;/div>
&lt;h3 id="episode-4">Episode 4:&lt;/h3>
&lt;p>How to run your configured project in a dev container.&lt;/p>
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe src="https://www.youtube.com/embed/ELdZxGtqu6w" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video">&lt;/iframe>
&lt;/div>
&lt;h3 id="episode-5">Episode 5:&lt;/h3>
&lt;p>How to forward a port from your container to your host machine so that you can access the app in the browser.&lt;/p>
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe src="https://www.youtube.com/embed/3iTZFxfzGl8" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video">&lt;/iframe>
&lt;/div>
&lt;h3 id="episode-6">Episode 6:&lt;/h3>
&lt;p>How to customize your dev container configuration.&lt;/p>
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe src="https://www.youtube.com/embed/YtiAUoh2U9A" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video">&lt;/iframe>
&lt;/div>
&lt;h3 id="episode-7">Episode 7:&lt;/h3>
&lt;p>How to install additional software in your Development container.&lt;/p>
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe src="https://www.youtube.com/embed/dfj7WxfC_9M" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video">&lt;/iframe>
&lt;/div>
&lt;h3 id="episode-8">Episode 8:&lt;/h3>
&lt;p>Wrap-up and where to go to learn more about Remote Development.&lt;/p>
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe src="https://www.youtube.com/embed/oKXkZaAn-IA" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video">&lt;/iframe>
&lt;/div>
&lt;h2 id="enjoy-your-free-knowledge">Enjoy your free knowledge&lt;/h2>
&lt;p>We hope you enjoy this series on Development Containers. You can check out the &lt;a href="https://www.youtube.com/watch?v=61M2takIKl8&amp;amp;list=PLj6YeMhvp2S5G_X6ZyMc8gfXPMFPg3O31">full playlist on YouTube&lt;/a> or &lt;a href="https://dev.azure.com/devrel/Cloud%20Advocacy/_boards/board/t/Developer%20Cloud/Work%20Items?WT.mc_id=devcloud-11496-buhollan">Microsoft Developer Studios&lt;/a>.&lt;/p></description></item><item><title>Using Azure Logic Apps to auto-print sales orders</title><link>https://burkeholland.github.io/posts/low-code-value/</link><pubDate>Mon, 08 Feb 2021 14:52:29 -0600</pubDate><guid>https://burkeholland.github.io/posts/low-code-value/</guid><description>&lt;p>No / Low Code tools (NoLow - I just coined that) have been the holy grail of software since I got into programming. I remain optimistic, but skeptical in regards to the idea that some day anyone will be able to build apps.&lt;/p>
&lt;p>Optimistic because we really need to get humans out of the business of writing code wherever we can. Less code means less bugs. Skeptical because in the 15 years I&amp;rsquo;ve been a developer, I&amp;rsquo;ve watched so many of these tools come and go. The problem isn&amp;rsquo;t that we haven&amp;rsquo;t made the right tools, it&amp;rsquo;s that you still need to have significant level of technical knowledge about &lt;em>how&lt;/em> a problem can be solved. And that&amp;rsquo;s not something you can abstract away with a nicer UI.&lt;/p>
&lt;p>I think the strongest case for the success of NoLow at the moment has more to do with what it offers current developers than it&amp;rsquo;s ability to turn non-coders into application developers.&lt;/p>
&lt;h2 id="a-nolow-real-world-use-case">A NoLow real world use case&lt;/h2>
&lt;p>My wife owns a small business. It&amp;rsquo;s one of those yard sign businesses that have exploded in popularity during the pandemic. I was skeptical of the long-term viability of a business built on corrugated blown up letters stuck in your yard, but when she put up a sign for my birthday, it did make me feel special and I can understand why she&amp;rsquo;s getting 5 and 6 orders a day at around 75 bucks a pop.&lt;/p>
&lt;p>&lt;img src="https://burkeholland.github.io/media/low-code-value/yard-sign.JPEG" alt="Example yard sign in front of a house">&lt;/p>
&lt;p>I am defacto tech support for all the digital aspects of her business. Since it&amp;rsquo;s a franchise, nearly everything she needs is provided by the company. And, if I might add, it&amp;rsquo;s pretty good. She complains, but she has never used enterprise software before so her only frame of reference is her iPhone, on which everything kind of &amp;ldquo;just works&amp;rdquo;.&lt;/p>
&lt;p>From time to time, she has small automation needs. For instance, she gets orders emailed to her every day. She then has to print those orders out. So she made a simple request to have orders just automatically print out whenever they come in.&lt;/p>
&lt;p>I was halfway to building a Node application that auth&amp;rsquo;d to Gmail, parsed the body with an HTML parser and an npm package to send things to the printer before I realized that this is probably all solvable with low code tools.&lt;/p>
&lt;p>So I built an &lt;a href="https://docs.microsoft.com/azure/logic-apps/quickstart-create-first-logic-app-workflow?WT.mc_id=devcloud-15662-buhollan">Azure Logic App&lt;/a> that does this in - no joke - two steps.&lt;/p>
&lt;h2 id="building-the-logic-app">Building the Logic App&lt;/h2>
&lt;p>First I had some prep work to do.&lt;/p>
&lt;p>I added a label to any incoming order email with an &amp;ldquo;Order&amp;rdquo; label. Gmail calls these &amp;ldquo;filters&amp;rdquo; by the way. The order format ALWAYS starts the same way and they always come from the same sender. Anybody could write this filter.&lt;/p>
&lt;p>&lt;img src="https://burkeholland.github.io/media/low-code-value/email-filter.jpg" alt="Gmail filter screen showing new filter">&lt;/p>
&lt;blockquote>
&lt;p>Note: the easiest way to do this whole thing would be to forward the email once it comes in via the same filter in Gmail - cause you can do that. Unfortunately, this doesn&amp;rsquo;t work. For some reason, the printer won&amp;rsquo;t accept forwarded emails. I lost about an hour to that weirdness.&lt;/p>
&lt;/blockquote>
&lt;p>I started with a blank Logic App and added the Gmail Trigger to start. It has the ability to check for new mail, and you can even specify a label to filter on.&lt;/p>
&lt;p>&lt;img src="https://burkeholland.github.io/media/low-code-value/gmail-trigger.jpg" alt="Logic App showing Gmail Trigger settings">&lt;/p>
&lt;p>The next step is to add an action that sends any emails it found in step one to the printer. I&amp;rsquo;ve got an HP Envy 5640 that supports &lt;a href="https://support.hp.com/us-en/document/c03721293">HP ePrint&lt;/a> - &amp;ldquo;a cloud-based service that lets you print from anywhere&amp;hellip;&amp;rdquo;. Once you set it up, you get a super ugly email address that looks like &lt;code>kslf11skjflk83@hpeprint.com&lt;/code>. But anything you send to that ugliness from a &amp;ldquo;trusted&amp;rdquo; sender will print. It works well.&lt;/p>
&lt;p>&lt;img src="https://burkeholland.github.io/media/low-code-value/full-logic-app.jpg" alt="Logic App showing Gmail Trigger settings and Gmail send email action">&lt;/p>
&lt;blockquote>
&lt;p>I put the printer email in a Logic App parameter so it&amp;rsquo;s not part of the program itself. That&amp;rsquo;s the coder in me. I can&amp;rsquo;t help it.&lt;/p>
&lt;/blockquote>
&lt;p>This runs every 3 minutes and prints new orders when they come in.&lt;/p>
&lt;p>And it is deceptively simple.&lt;/p>
&lt;p>Consider what actually has to occur for this to work&amp;hellip;&lt;/p>
&lt;ol>
&lt;li>Authentication to Gmail on my behalf, implementing an OAuth flow and storing tokens for future requests.&lt;/li>
&lt;li>Querying for any &amp;ldquo;new&amp;rdquo; emails with a particular label&lt;/li>
&lt;li>Parsing the parts of the email and preserving the HTML of the body&lt;/li>
&lt;li>Sending an email on my behalf&lt;/li>
&lt;/ol>
&lt;p>10 years ago we would have coded this from scratch and it would have taken a week - at least. And I would consider this &amp;ldquo;advanced&amp;rdquo; coding given the auth flow requirements. And think of the bugs, testing and maintenance down the line.&lt;/p>
&lt;h2 id="could-anyone-do-this">Could anyone do this?&lt;/h2>
&lt;p>So back to the point - could &lt;em>anyone&lt;/em> do this? It is pretty simple. Certainly a user with a moderate amount of technical knowledge could piece the Logic App together. But could they pull the &lt;em>whole&lt;/em> thing off by themselves?&lt;/p>
&lt;p>I&amp;rsquo;m not so sure. There are a lot of things that I just glossed over where you could get seriously hung up. Think of what you have to &lt;em>know&lt;/em> to build this&amp;hellip;&lt;/p>
&lt;ul>
&lt;li>You have to know that you need to query a collection of items (emails) based on a condition (label)&lt;/li>
&lt;li>You have to know that modern printers have this &amp;ldquo;email to printer&amp;rdquo; capability which requires you to know the printer&amp;rsquo;s IP address which means&amp;hellip;&lt;/li>
&lt;li>You have to know about IP addresses, that they are dynamic, that this will ultimately break your app which means&amp;hellip;&lt;/li>
&lt;li>That you need to change the printer IP to static which means&amp;hellip;&lt;/li>
&lt;li>You have to know how to log-in to your router and configure DHCP.&lt;/li>
&lt;/ul>
&lt;p>Coding is not just knowledge of a language. It is broad knowledge of platforms, and how systems communicate.&lt;/p>
&lt;p>Optimistic, but skeptical.&lt;/p>
&lt;p>For now, I think that NoLow apps might work for certain types of applications - a la &amp;ldquo;forms over data&amp;rdquo; like Microsoft Access. But the real &amp;ldquo;arrived&amp;rdquo; value might, at least today, seems to be enabling current developers to be more productive. It remains to be seen if developers will adopt these tools in lieu of a lucrative career inventing wheels.&lt;/p></description></item><item><title>How to configure a root domain in an Azure Static Web App</title><link>https://burkeholland.github.io/posts/static-app-root-domain/</link><pubDate>Wed, 06 May 2020 14:55:57 -0600</pubDate><guid>https://burkeholland.github.io/posts/static-app-root-domain/</guid><description>&lt;h3>This article is now obsolete.&lt;/h3>
&lt;p>Please use the official &lt;a href="https://docs.microsoft.com/azure/static-web-apps/custom-domain?tabs=azure-dns&amp;WT.mc_id=devcloud-0000-buholland">Custom Domain support&lt;/a>in Azure Static Web Apps.&lt;/p></description></item><item><title>Professional quality audio with the Blue Yeti, GarageBand and Screenflow</title><link>https://burkeholland.github.io/posts/audio-how-to/</link><pubDate>Wed, 18 Mar 2020 16:06:44 -0600</pubDate><guid>https://burkeholland.github.io/posts/audio-how-to/</guid><description>&lt;p>One of the best things you can do to improve the quality of your screencasts, is improve the quality of your audio.&lt;/p>
&lt;p>I’m assuming that unless your name is “Dr. Dre”, you probably do not have a professional sound studio in your basement full of high-end equipment and expensive software. And if you’re like me, you don’t even have a basement.&lt;/p>
&lt;p>What I &lt;em>do&lt;/em> have is a Blue Yeti microphone, GarageBand and a copy of Screenflow that I can barely afford. I’ve struggled for a long time to get my audio to sound “good”. I’ve gone back and forth on what the bar for that is. When I first got started, everything I recorded sounded like I was at the bottom of an empty can of tomato soup. With the help of some friends, some Googling and the wisdom of my wife, I’ve seriously improved my station. In this post, I’ll share with you the tips and tricks that you can use to immediately improve your audio quality.&lt;/p>
&lt;h2 id="the-room">The Room&lt;/h2>
&lt;p>First off, let’s talk about your recording space. You are going to want to work and record in the same area. I used to unplug and go into my closet and record. You don’t need to do this. But you do need to do some basic things to your work area.&lt;/p>
&lt;p>When I first started recording in my office, everything was so echo’y. It sounded like I was in a bathtub. My wife pointed out to me that the bare walls, window and floor were not helping. She instituted 3 things in my office that made a whole world of difference.&lt;/p>
&lt;ol>
&lt;li>
&lt;p>She got an area rug. If you have hardwood, tile or laminate floors, an area rug is going to be essential. Sound &lt;strong>loves&lt;/strong> to bounce off anything it can, and it &lt;em>really&lt;/em> likes hard, flat surfaces. An area rug will work wonders.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>She hung curtains next to the window. My drapes don’t even close. They are just there to soak up the sound.&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>&lt;img src="https://burkeholland.github.io/media/office-curtains.jpg" alt="">&lt;/p>
&lt;ol>
&lt;li>She hung things on the walls. Pictures, guitars, sock monkeys. You get the idea.&lt;/li>
&lt;/ol>
&lt;p>&lt;img src="https://burkeholland.github.io/media/office-walls.jpg" alt="">&lt;/p>
&lt;p>These 3 things were enough to dampen the sound in the room so that it is fit for recording. You don’t actually need a bunch of sound panels or a special box you made out of plywood that sits weirdly in your garage. Just a rug, some drapes and a few wall treatments will do the trick.&lt;/p>
&lt;p>Next, let’s talk about the equipment.&lt;/p>
&lt;h2 id="the-equipment">The Equipment&lt;/h2>
&lt;p>At the risk of looking extremely self-absorbed, here is a picture of my current recording setup…&lt;/p>
&lt;p>&lt;img src="https://burkeholland.github.io/media/my-setup.jpg" alt="">&lt;/p>
&lt;p>My setup will run you about 250$ total. Here are the essential components:&lt;/p>
&lt;h3 id="blue-yeti-microphonehttpswwwamazoncomblue-yeti-usb-microphone-blackoutdpb00n1ypxw2refsr_1_2keywordsblueyetiqid1584566560sr8-2-130">&lt;a href="https://www.amazon.com/Blue-Yeti-USB-Microphone-Blackout/dp/B00N1YPXW2/ref=sr_1_2?keywords=blue+yeti&amp;amp;qid=1584566560&amp;amp;sr=8-2">Blue Yeti Microphone&lt;/a> (130$)&lt;/h3>
&lt;p>This is probably the most popular mic on the market. Some people will say the RODE is better, but don’t listen to them. Listen to me. I’m writing the blog post.&lt;/p>
&lt;h3 id="rode-psa-1-swivel-mount-boom-armhttpswwwamazoncomgpproductb001d7uyborefppx_yo_dt_b_search_asin_titleieutf8psc1-100">&lt;a href="https://www.amazon.com/gp/product/B001D7UYBO/ref=ppx_yo_dt_b_search_asin_title?ie=UTF8&amp;amp;psc=1">RODE PSA 1 Swivel Mount Boom Arm&lt;/a> (100$)&lt;/h3>
&lt;p>If you plan to record audio and the screen at the same time, you have got to get the mic off of your work surface. If you don’t, the mic is going to pick up the concussion from your typing and it’s going to sound less like a keyboard and more like a death metal drum solo.&lt;/p>
&lt;h3 id="foam-windscreenhttpswwwamazoncomgpproductb01bxay8k8refppx_yo_dt_b_search_asin_titleieutf8psc1-13">&lt;a href="https://www.amazon.com/gp/product/B01BXAY8K8/ref=ppx_yo_dt_b_search_asin_title?ie=UTF8&amp;amp;psc=1">Foam Windscreen&lt;/a> (13$)&lt;/h3>
&lt;p>You’ll see people with fancy windscreens and pop filters. That’s the big circle that you usually see between the mic and Taylor Swift when she’s in the recording studio. I &lt;em>almost&lt;/em> bought one of these until my colleague &lt;a href="https://twitter.com/spboyer">Shayne Boyer&lt;/a> pointed out that you can buy a 13$ Windscreen and it works brilliantly.&lt;/p>
&lt;p>OK - that’s the equipment. Let’s talk about the mic configuration for a moment. There are a few key things you need to know about it.&lt;/p>
&lt;h2 id="mic-configuration">Mic Configuration&lt;/h2>
&lt;p>The Blue Yeti is a condensor mic. This means that it’s super sensitive. If you don’t adjust it correctly, it’s going to pick up everything. And I do mean everything. If someone next door sneezes, your ears won’t pick it up, but I swear you will hear it on the video.&lt;/p>
&lt;p>You can fix this, you just need to get the settings right. On the mic, there is a side that has a “Gain” and a “Pattern” option.&lt;/p>
&lt;p>&lt;img src="https://burkeholland.github.io/media/pattern-gain.jpg" alt="">&lt;/p>
&lt;p>The “Gain” is how sensitive you want the mic to be. Since you only want it recording your voice, you want to turn the gain all the way down. That seems completely counter-intuitive, but I promise, this is where you want it.&lt;/p>
&lt;p>The “Pattern” controls where on the mic the audio is picked up. All you have to know here is to pick the upside-down ♡ setting. This setting means that the microphone will pick up audio from the front-side only. That’s the side you are speaking into, so that’s what you want.&lt;/p>
&lt;p>&lt;img src="https://burkeholland.github.io/media/yeti-front.jpg" alt="">&lt;/p>
&lt;p>When you talk into the mic, you want it upright like you see it in the picture above. Talk into it from the front side, not the very top. The Blue Yeti site shows it like this…&lt;/p>
&lt;p>&lt;img src="https://burkeholland.github.io/media/do-dont.jpg" alt="">&lt;/p>
&lt;p>OK - you’re setup to record. The next step is to configure the recording software. When I record screencasts, I record audio first, then I record the video and edit it to go with the audio. This is so that I can record the audio with GarageBand and edit it before I add in the video.&lt;/p>
&lt;h2 id="working-with-garageband">Working with GarageBand&lt;/h2>
&lt;p>If you don’t have a Mac, I’m sorry. Feel free to skip over this section, and frankly, the rest of this post. I have no idea how to do this on Windows, although I’m sure there are some great alternatives.&lt;/p>
&lt;p>For you Mac people, Garage Band is really all you need.&lt;/p>
&lt;p>I record a Narration vocal and I created a custom audio setting using &lt;a href="https://twitter.com/nraboy">Nic Raboy’s&lt;/a> excellent setup from &lt;a href="https://www.thepolyglotdeveloper.com/2016/02/create-podcast-episode-garageband-mac/">an article on this same topic&lt;/a>.&lt;/p>
&lt;p>&lt;img src="https://burkeholland.github.io/media/garageband-settings.jpg" alt="">&lt;/p>
&lt;p>Now, change the way GarageBand is showing your track. By default, it shows “Beats and Project”, which displays your audio over time as “Bars”. This isn’t super helpful for seeing how long your track really is. To fix this, you want to change this so it displays your track as “Time”. This is a hard menu to find, but it’s that tiny arrow next to the “key” display.&lt;/p>
&lt;p>&lt;img src="https://burkeholland.github.io/media/garageband-tiny-arrow.jpg" alt="">&lt;/p>
&lt;p>Select “Time” from the menu that pops up.&lt;/p>
&lt;p>&lt;img src="https://burkeholland.github.io/media/garageband-time.jpg" alt="">&lt;/p>
&lt;p>After you record your audio, you’ll want to edit out your breathing, as well as pops and clicks and other mouth sounds you would rather not expose your listeners to. To do that, select the “Show Editor” option from the view menu.&lt;/p>
&lt;p>&lt;img src="https://burkeholland.github.io/media/garageband-show-editor.jpg" alt="">&lt;/p>
&lt;p>This will open up an editor in the bottom area that allows you to zoom in and edit out parts of the track. You’ll be able to see your breathing just by looking at the track. It’s the flat part in between sections. To remove that area, click and drag to highlight the region you want to remove, and then press “Delete”.&lt;/p>
&lt;p>&lt;img src="https://burkeholland.github.io/media/garageband-click-and-drag.jpg" alt="">&lt;/p>
&lt;p>If you want to move your sections of audio closer together as you cut out the breathing, use the upper track portion. To do the fine grain editing itself, use the editor portion below.&lt;/p>
&lt;p>OK! All your heavy breathing is now out of the picture and your audio sounds good. Export from GarageBand using the “Share/Export Song To Disk” option.&lt;/p>
&lt;p>The last step is to pull it into Screenflow and apply some final tweaks.&lt;/p>
&lt;h2 id="screenflow-audio-tweaks">Screenflow Audio Tweaks&lt;/h2>
&lt;p>Again, this is Mac specific. I do feel bad about the lack of cross-platform-icity in this article. That’s got to count for something.&lt;/p>
&lt;p>In Screenflow, I pull in the audio and then I record my screen to match the audio. This can be a bit tedious, but usually results in a higher quality video. One of the last things I do is tweak the audio in Screenflow.&lt;/p>
&lt;p>I select the entire audio segment and I apply two options…&lt;/p>
&lt;ol>
&lt;li>Smooth Volume Levels&lt;/li>
&lt;li>Remove Background Noise (50%)&lt;/li>
&lt;/ol>
&lt;p>&lt;img src="https://burkeholland.github.io/media/screenflow-audio.jpg" alt="">&lt;/p>
&lt;h2 id="andcut">And…..CUT&lt;/h2>
&lt;p>That’s it! Hopefully there are some tips in here that you find helpful. Don’t be too hard on yourself over your audio. You are never going to get it perfect, but these simple steps should get you about 90% of the way there. The last 10% is all found in Dr. Dre’s basement.&lt;/p>
&lt;p>Oh - and here’s a sample of my audio sounds. FWIW, the bass intro was also recorded in GarageBand…&lt;/p>
&lt;div style="text-align: center;">&lt;iframe width="720" height="405" src="https://www.youtube.com/embed/I789I_aa8UM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="">&lt;/iframe>&lt;/div></description></item><item><title>Trimming expenses on The Urlist with Azure Cosmos DB Free Tier</title><link>https://burkeholland.github.io/posts/cosmos-free-tier/</link><pubDate>Tue, 17 Mar 2020 16:09:16 -0600</pubDate><guid>https://burkeholland.github.io/posts/cosmos-free-tier/</guid><description>&lt;summary>
Summary: We migrated &lt;a href="https://www.theurlist.com">theurlist.com&lt;/a> to the new Cosmos DB Free Tier and shaved ~35$ per month off of our Azure bill. Cosmos DB Free Tier gives you 400 RU/s for free every month. This should be more than enough for most small projects.
&lt;p>&lt;/p>
&lt;div class="cta-container">&lt;a class="cta" href="https://devblogs.microsoft.com/cosmosdb/build-apps-for-free-with-azure-cosmos-db-free-tier/?WT.mc_id=personal-blog-buhollan">Get Azure Cosmos DB Free Tier&lt;/a>&lt;/div>
&lt;p>&lt;/p>
&lt;/summary>
&lt;p>&lt;/p>
&lt;p>&lt;a href="https://www.theurlist.com">theurlist.com&lt;/a> is a project that I wrote with my colleague &lt;a href="https://twitter.com/cecilphillip">Cecil Phillip&lt;/a> last year. We wanted to see if we could build a site on Azure that was two things…&lt;/p>
&lt;ol>
&lt;li>Serverless&lt;/li>
&lt;li>Cheap&lt;/li>
&lt;/ol>
&lt;p>Now you would think that “cheap” would go hand-in-hand with “Serverless”, and that’s true. But there are portions of theurlist.com that are not strictly “Serverless” by definition because those pieces didn’t exist in Azure at the time. One of those is our database - Azure Cosmos DB.&lt;/p>
&lt;p>Azure Cosmos DB is the NoSQL data store that backs everything that theurlist.com does. Cosmos DB does not yet allow you to pay by request, or only for what you use. You need to buy something called “Request Units per Second” up front in batches. The lowest amount you can buy is 400, and that costs ~24$ per month.&lt;/p>
&lt;p>The database for theurlist.com is dead simple. It’s one database with one collection.&lt;/p>
&lt;p>&lt;img src="https://burkeholland.github.io/media/linkylinkdb.png" alt="Cosmos DB instance in Data Explorer">&lt;/p>
&lt;blockquote>
&lt;p>The database is called “linkylinkdb”. The original working name for this project was “Linky Link”. Although &lt;a href="http://linkylink.com/">linkylink.com&lt;/a> was already registered and is the home page of a dog named “Lincoln” where you can see a slide show of him in various poses. It’s probably a better use of the URL if we’re being honest.&lt;/p>
&lt;/blockquote>
&lt;p>Monthly traffic to theurlist.com is around 60K visits. This equates to around 2 ru/s in Cosmos DB. TWO. We are currently paying for 400. That’s 200 times more throughput than we need and we’re paying for it. And sometimes we don’t even use that. In fact, in the last 7 days, we haven’t even averaged 1.&lt;/p>
&lt;p>&lt;img src="https://burkeholland.github.io/media/cosmos-db-rus.png" alt="The average number of Cosmos DB RU/s displayed in Azure portal">&lt;/p>
&lt;p>Our 400 RU cost each month, combined with with us occasionally upping the RU/s to do load testing demos tipped our total Cosmos DB bill to around 32$ per month.&lt;/p>
&lt;p>&lt;img src="https://burkeholland.github.io/media/cosmos-db-old-cost.png" alt="Cosmos DB cost summary">&lt;/p>
&lt;p>Most of that we simply aren’t using, but we have to pay for it anyway. Which, doesn’t feel great. In our endless persuit of running a cost-effective app on Azure, we were excited to learn about the launch of the new Cosmos DB Free Tier.&lt;/p>
&lt;h2 id="migrating-to-the-cosmos-db-free-tier">Migrating to the Cosmos DB Free Tier&lt;/h2>
&lt;p>Cosmos DB has officially launched a &lt;a href="https://devblogs.microsoft.com/cosmosdb/build-apps-for-free-with-azure-cosmos-db-free-tier/?WT.mc_id=personal-blog-buhollan">free tier&lt;/a>. But what exactly does that mean?&lt;/p>
&lt;p>Free Tier allows you to have one Cosmos DB account where you apply a “Free Tier” discount. This gives you the first 400 RU/s free every month. They are deducted from the bill. For theurlist.com, this is perfect. We aren’t anywhere &lt;em>near&lt;/em> 400 RU/s. And based on my calculations, if 60K views equates to 2 RU/s, we could go up to 12 MILLION requests per month before we get to 400 RU/s. That’s a LOT of traffic.&lt;/p>
&lt;p>Last week, we migrated our database to the Cosmos DB free tier. We filmed the whole thing so you can see how to move your Cosmos DB database if you’ve got a small project like we do. There are two options you can use in terms of tools to do this.&lt;/p>
&lt;ol>
&lt;li>&lt;a href="https://ms-adf.azure.com?WT.mc_id=personal-blog-buhollan">Azure Data Factory&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://ms-adf.azure.com?WT.mc_id=personal-blog-buhollan">Cosmos DB Migration Tool&lt;/a>&lt;/li>
&lt;/ol>
&lt;p>The Cosmos DB Migration tool is Windows only, so we opted for the Azure Data Factory, which is browser-based.&lt;/p>
&lt;p>The downside of the Azure Data Factory is that we had to create the database and collection before we could migrate the data. If you have a lot of databases or collections, and or you have lots of triggers and stored procedures, you’re better off using the Cosmos DB Migration Tool.&lt;/p>
&lt;p>We decided to record the process in case you are looking to migrate your own Cosmos DB database to the Free Tier. Enjoy!&lt;/p>
&lt;div style="text-align: center;">&lt;iframe width="720" height="405" src="https://www.youtube.com/embed/kEuEvPtgaK0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="">&lt;/iframe>&lt;/div></description></item><item><title>Cosmos CRUD</title><link>https://burkeholland.github.io/posts/cosmos-crud/</link><pubDate>Sun, 02 Feb 2020 16:24:55 -0600</pubDate><guid>https://burkeholland.github.io/posts/cosmos-crud/</guid><description>&lt;p>&lt;a href="https://docs.microsoft.com/azure/cosmos-db/sql-api-nodejs-application?WT.mc_id=personal-blog-buhollan">Cosmos DB JavaScript SDK&lt;/a> is clean - I like it. But I feel like I always end up forgetting how to CRUD.&lt;/p>
&lt;p>For the uninitiated in database street-slang, CRUD means Create, Read, Update And Delete. Feel free to use that if you find yourself in a turf war or dance-off.&lt;/p>
&lt;p>Well, I take that back. I can “read” everything purty gud. Actually, I can “create” as well. It’s the retrieving of one item that always throw me off. This is because of partition keys. Partition keys always hang me up (because I am but a simple man) and, well, I need a reminder for how they do and don’t affect retrieving an item, so that’s what I’m going to document in this here article.&lt;/p>
&lt;p>Assume that we’re working with the following document structure with a partition key on “/brand/name”.&lt;/p>
&lt;div class="highlight">
&lt;pre>&lt;code>{
&amp;quot;name&amp;quot;: &amp;quot;Artificial Tree&amp;quot;,
&amp;quot;price&amp;quot;: 250,
&amp;quot;brand&amp;quot;: {
&amp;quot;name&amp;quot;: &amp;quot;Drillco&amp;quot;
},
&amp;quot;stockUnits&amp;quot;: 654,
&amp;quot;id&amp;quot;: &amp;quot;66d7134f-ee03-4cab-b448-ab3bb5098a6f&amp;quot;
}
&lt;/code>&lt;/pre>
&lt;/div>
&lt;p>Assume that all of the following examples have the following connection information…&lt;/p>
&lt;div class="highlight">
&lt;pre>&lt;code>import { CosmosClient } from &amp;quot;@azure/cosmos&amp;quot;;
const client = new CosmosClient(process.env.CONNECTION_STRING);
const database = client.database(&amp;quot;tailwind&amp;quot;);
const container = database.container(&amp;quot;products&amp;quot;);
&lt;/code>&lt;/pre>
&lt;/div>
&lt;h2 id="creating-an-item">Creating an item&lt;/h2>
&lt;div class="highlight">
&lt;pre>&lt;code>async create(product: Product) {
let { resource } = await container.items.create(productToCreate);
return resource;
}
const product = await create({
name: &amp;quot;Hammer&amp;quot;,
price: 10,
brand: {
name: ACME
},
stockUnits: 1500
});
&lt;/code>&lt;/pre>
&lt;/div>
&lt;blockquote>
&lt;p>Note that Cosmos DB auto-creates an id if you don’t pass one in. It will be a GUID.&lt;/p>
&lt;/blockquote>
&lt;h2 id="reading-all-items">Reading all items&lt;/h2>
&lt;div class="highlight">
&lt;pre>&lt;code>async readAll() {
let iterator = container.items.readAll();
let { resources } = await iterator.fetchAll();
return resources;
}
const products = await readAll();
&lt;/code>&lt;/pre>
&lt;/div>
&lt;h2 id="reading-one-item">Reading one item&lt;/h2>
&lt;div class="highlight">
&lt;pre>&lt;code>async read(id: string, brand: string) {
let { resource } = container.item(id, brand).read();
return resource;
}
const product = await read(&amp;quot;66d7134f-ee03-4cab-b448-ab3bb5098a6f&amp;quot;, &amp;quot;Drillco&amp;quot;);
&lt;/code>&lt;/pre>
&lt;/div>
&lt;p>Sometimes you don’t have a partition key. In that case, you’ll want to pass &lt;code>undefined&lt;/code> as the second parameter.&lt;/p>
&lt;div class="highlight">
&lt;pre>&lt;code>async read(id: string) {
let { resource } = container.item(id, undefined).read();
return resource;
}
const product = await read(&amp;quot;66d7134f-ee03-4cab-b448-ab3bb5098a6f&amp;quot;);
&lt;/code>&lt;/pre>
&lt;/div>
&lt;h2 id="update-an-item">Update an item&lt;/h2>
&lt;div class="highlight">
&lt;pre>&lt;code>async update(product: Product) {
// just like with reading one item, if your collection doesn't have a partition key,
// pass &amp;quot;undefined&amp;quot; as the second parameter - container.item(product.id, undefined);
let itemToUpdate = container.item(product.id, product.brand.name);
let { resource } = itemToUpdate.replace(product);
return resource;
}
const product = await update({
name: &amp;quot;Artificial Tree Updated&amp;quot;,
price: 250,
brand: {
&amp;quot;name&amp;quot;: &amp;quot;Drillco&amp;quot;
},
stockUnits: 654,
id: &amp;quot;66d7134f-ee03-4cab-b448-ab3bb5098a6f&amp;quot;
});
&lt;/code>&lt;/pre>
&lt;/div>
&lt;blockquote>
&lt;p>Note that you &lt;strong>have&lt;/strong> to include the id on the object that you pass in to the &lt;code>replace&lt;/code> function. Even though you already specified it when you retrieved the item to update.&lt;/p>
&lt;/blockquote>
&lt;h2 id="delete-an-item">Delete an item&lt;/h2>
&lt;div class="highlight">
&lt;pre>&lt;code>async destroy(id: string, brand: string) {
// just like with reading one item, if your collection doesn't have a partition key,
// pass &amp;quot;undefined&amp;quot; as the second parameter - container.item(product.id, undefined).delete();
await container.item(id, brand).delete();
}
await destroy(&amp;quot;66d7134f-ee03-4cab-b448-ab3bb5098a6f&amp;quot;, &amp;quot;Drillco&amp;quot;)
&lt;/code>&lt;/pre>
&lt;/div>
&lt;h2 id="partition-key-values-vs-names">Partition key values vs names&lt;/h2>
&lt;p>The main takeaway from this article (besides my poor use of grammer and analogy) should be that CosmosDB wants a partition key VALUE, not name. When I was first working with the SDK, I would try to pass in the partition key name (/brand/name). This would throw an error telling me that an object with id of &lt;em>whatever&lt;/em> didn’t exist. That’s because I needed to pass in the &lt;em>value&lt;/em> of the partition key, not the name. This is why you need to pass in &lt;em>undefined&lt;/em> if you do &lt;strong>not&lt;/strong> have a partition key defined for your collection.&lt;/p>
&lt;p>There is a pretty good tutorial you can go through &lt;a href="https://docs.microsoft.com/azure/cosmos-db/sql-api-nodejs-application?WT.mc_id=personal-blog-buhollan">here&lt;/a> that covers this in more detail and shows it in a Node/Express context.&lt;/p>
&lt;p>I hope this helps. Good luck out there.&lt;/p></description></item><item><title>How to create a Reminder on Apple Watch without creating a Reminder</title><link>https://burkeholland.github.io/posts/apple-watch-reminders/</link><pubDate>Wed, 29 Jan 2020 14:34:39 -0600</pubDate><guid>https://burkeholland.github.io/posts/apple-watch-reminders/</guid><description>&lt;p>I have an Apple Watch (&lt;strong>not&lt;/strong> cellular), and I love it. Not just because it lets everyone know that I’m better than them, but also for it’s ability to sync and store all of my audio to be used offline. I can download my music (including Apple Music), podcasts and &lt;a href="https://www.audible.com/ep/apple">now even Audible books&lt;/a> to my Watch and take it all with me when I exercise. This means I don’t have to strap my iPhone to arm like giant medievil shield. I can’t understate how much I enjoy this feature of the watch. If all the thing could do was play my music, podcasts and audio books without requiring a connection, it would still be worth the price.&lt;/p>
&lt;p>The one other thing that I use the Watch for with some frequency, is reminders.&lt;/p>
&lt;p>Apple Reminders are how I function in life. I don’t know how everyone else out there gets by, but I always feel like I have a thousand things that I need to get done. And if I don’t do them, nobody will. These are work things, yes. But they are also personal items: pay off the credit card. Pick up medication. Remind one of the kids about an upcoming assignment that there is a 100% chance they have not yet completed.&lt;/p>
&lt;p>I create these reminders with Siri via the Apple Watch. Now, I’d like to gloss over that last sentence because I have so much to say about how much I don’t enjoy that. Or the fact that it only works about 50% of the time. The rest of the time it just ignores me, cuts me off, or creates a cryptic reminder that is a pretty far cry from what I actually said. Like this one…&lt;/p>
&lt;p>&lt;img src="https://burkeholland.github.io/media/reminder-bs.png" alt="Apple Reminder that says &amp;amp;ldquo;Finish the BS of a proposal&amp;amp;rdquo;">&lt;/p>
&lt;p>I mean, all my proposals are technically BS, but I have no idea what this is supposed to mean. Here’s another one…&lt;/p>
&lt;p>&lt;img src="https://burkeholland.github.io/media/reminder-warts.png" alt="Apple Reminder that says &amp;amp;ldquo;Paint the warts&amp;amp;rdquo;">&lt;/p>
&lt;p>Again. I’m nearly certain that is not what I said. Now I have to decode that like some sort of Saturday morning NPR gameshow.&lt;/p>
&lt;p>And look - my memory is bad and getting worse. When I say I use Reminders a lot, I mean it. I use it for everything. For example…&lt;/p>
&lt;p>&lt;img src="https://burkeholland.github.io/media/reminder-gate-check.png" alt="Apple Reminder that says &amp;amp;ldquo;You gate checked your bag&amp;amp;rdquo;">&lt;/p>
&lt;p>I would (and have) walked off the plane and nearly made it to an Uber before I remembered that I don’t have my bag. It’s that bad y’all. You have no idea what it was like trying to get through school as a child. Or if you have ADD, maybe you do. I have three kids and one of them struggles with it just like I did. He can barely remember to leave the house with pants on, let alone what homework he needs to do, what paper is where or what test is when. So I set an Apple Reminder for myself to remind him. Apple Reminders are how I function in life.&lt;/p>
&lt;p>The thing is, you can’t create a reminder from your Apple Watch if the phone isn’t nearby. I always have my phone on me or at least nearby. Unless I’m out jogging.&lt;/p>
&lt;h2 id="jogging-the-memory">Jogging the memory&lt;/h2>
&lt;p>For some reason, jogging my body also jogs my brain. I tend to remember something important that I need to do when I’m 2.5 miles from the house and my phone. This is a panicky moment for me. I have an important thing I need to do, and there is no way I will remember by the end of my run. I know myself too well. But I can’t create a reminder because Siri won’t work without the phone. This has happened to me so often that I came up with a way to use my phone to create a Reminder quickly (while I’m running) and offline, without actually creating a reminder.&lt;/p>
&lt;p>It’s simple - just change the Watch face.&lt;/p>
&lt;p>By default, my Watch face is the “Infograph Modular”. For those who don’t know all of the Apple Watch faces by name, that’s this one…&lt;/p>
&lt;center>![Infograph Modular Apple Watch face](/media/infograph-modular.png)&lt;/center>
&lt;p>If I swipe right (swipe-right joke redacted) two times, I get the Mickey Mouse face…&lt;/p>
&lt;center>![Mickey Mouse Apple Watch face](/media/mickey-mouse.png)&lt;/center>
&lt;p>Now, at some point after I get home and finish my run, I will look at my watch and see Mickey. That will remind me of the thing I need to do. It works. Every time. I can instantly recall what I was thinking of at the time I made Mickey front-and-center in my life. Then I complete the task and change the face back.&lt;/p>
&lt;p>Now here’s what’s fascinating - this &lt;em>doesn’t&lt;/em> work if I switch to some other face besides Mickey. It will work in so much as it reminds me that I needed to do something, but at least 50% of the time I can’t remember what that something is!&lt;/p>
&lt;p>I have completely unscientific idea as to why my brain is able to associate Mickey with another idea, and use that as a marker for recall with almost 100% accuracy. The difference between the Mickey face and all the other faces is that Mickey illicits an emtional response from me. It’s slight, but it’s there. I &lt;em>think&lt;/em> it’s nastalgia. That seems most likely since Disney was such a core part of my childhood. Even as an adult, the thought of going to Disney World gets me excited, and I’m really not that into Disney anymore as a 41 year-old. I think it’s that emotional trigger coupled with the idea that makes the recall so effective. That’s what makes it stick. It’s not that I’m associating Mickey with “pay off the credit card” (although I’m sure a LOT of people do), but that I’m associating “Pay off the credit card” with the emotional response that is triggered when I &lt;em>see&lt;/em> Mickey.&lt;/p>
&lt;p>So I don’t know what this post is actually about. It’s either 1) How dissapointing Siri is 2) How to remember to do something by changing your Apple Watch face or 3) Why the brain is able to hold certain associations better than others. It was supposed to be #2, so let’s go with that. If you have an Apple Watch, now you know how to create a reminder without actually creating a reminder.&lt;/p></description></item><item><title>The 3 Laws of Serverless</title><link>https://burkeholland.github.io/posts/laws-of-serverless/</link><pubDate>Mon, 13 Jan 2020 16:43:32 -0600</pubDate><guid>https://burkeholland.github.io/posts/laws-of-serverless/</guid><description>&lt;p>A wise man once said this about Serverless…&lt;/p>
&lt;p>&lt;img src="https://burkeholland.github.io/media/serverless-quote.png" alt="Quote: It&amp;amp;rsquo;s not important to understand what serverless means. It&amp;amp;rsquo;s only important that you know the word an you are not afraid to use it in a blog post.">&lt;/p>
&lt;p>So wise! So profound. So obnoxiously vain to use your own quote.&lt;/p>
&lt;p>“Serverless”, is a buzzword. We can’t seem to agree on what it actaully means, so it ends up meaning nothing at all. Much like “cloud” or “dynamic” or “synergy”. You just wait for the right time in a meeting to drop it, walk to the board and draw a Venn Diagram, and then just sit back and wait for your well-deserved promotion.&lt;/p>
&lt;p>A lot of very smart people have &lt;em>tried&lt;/em> to define the word in a meaningful way. Here’s one that you might have seen before..&lt;/p>
&lt;blockquote>
&lt;p>Build applications without thinking about servers&lt;/p>
&lt;/blockquote>
&lt;p>I actually think this is pretty good at answering the “Wait! How can there be no server!!?!?!” question. But I think this definition falls a tad on the naive side.&lt;/p>
&lt;p>Nobody really thinks about servers when they are writing their code. I mean, I doubt any developer has ever thrown up their hands and said “Whoa, whoa, whoa. Wait just a minute. We’re not declaring any variables in this joint until I know what server we’re going to be running this on.” Or maybe you do. I have never ever done that. I always do it AFTER I’ve written the application. Come to think of it, maybe that explains a lot.&lt;/p>
&lt;p>But besides, isn’t that the whole point of a Platform as a Service (PaaS)? Don’t services like Azure and Heroku and a host of others already enable you to deploy your code without knowing anything about the physical server where it’s running? Haven’t we solved this problem?&lt;/p>
&lt;p>And if all of that is true, it seems to me that nearly everything in the cloud that is an “as a Service” product would be Serverless. Which means it would be easier to assume that everything is “Serverless” and just try to identify when something is not. I don’t even know what we could call that. Serverfull? Server as a Service? I know! VIRTUAL MACHINES.&lt;/p>
&lt;p>I don’t think you can explain Serverless in one sentence. This is because Serverless isn’t a single concept. It’s really 3 concepts that are used together to create a new type of cloud service. So don’t feel bad if your pug doesn’t get it when you try to break it down. It’s not your fault and a pug is a dog. I’m relatively sure that mine forgets nearly everything every 24 hours. Every day I tell it to get off the couch and it acts like it’s never heard this information before.&lt;/p>
&lt;p>Let’s look at the 3 properties that a technology must exhibit to be considered Serverless. These are the “Laws of Serverless”.&lt;/p>
&lt;h2 id="law-of-furthest-abstraction">Law of Furthest Abstraction&lt;/h2>
&lt;p>The “Law of Furthest Abstraction” says that you have no knowledge of the underlying system where your code runs.&lt;/p>
&lt;p>&lt;img src="https://burkeholland.github.io/media/law-furthest-abstraction.png" alt="A clipart picture of a person with the top of their head open to receive knowledge.">&lt;/p>
&lt;p>This is different from a PaaS. A PaaS hides the operating system, but you still need to know about the runtime and you still need to have some system knowledge.&lt;/p>
&lt;p>For instance, Azure’s PaaS is called “&lt;a href="https://azure.microsoft.com/try/app-service/?WT.mc_id=personal-blog-buhollan">App Service&lt;/a>”. When you create an App Service instance, you need to tell it what sort of App Service Plan you want to use. That service plan defines how much memory and CPU your instance will receive. For instance, here’s what the B (Basic) tier App Service Plans look like…&lt;/p>
&lt;p>&lt;img src="https://burkeholland.github.io/media/b-service-plans.png" alt="A listing of B tier service plans and resources granted with each one">&lt;/p>
&lt;p>This means App Service is not Serverless.&lt;/p>
&lt;p>A service in Azure that &lt;strong>is&lt;/strong> Serverless would be &lt;a href="https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-vs-code?WT.mc_id=personal-blog-buhollan">Azure Functions&lt;/a>. Azure Functions has no concept of App Service Plans. You run your code in Azure Functions and it will receive all the computing power that it needs when it needs it. It’s up to Azure Functions to figure that out.&lt;/p>
&lt;p>How does that even work?!?&lt;/p>
&lt;p>It works becdause of the second law of Serverless: The Law of Inherent Scale.&lt;/p>
&lt;h2 id="the-law-of-inherent-scale">The Law of Inherent Scale&lt;/h2>
&lt;p>The Law of Inherent Scale says that scaling is an intrinsic attribute of the technology; so much so that it just happens automatically.&lt;/p>
&lt;p>&lt;img src="https://burkeholland.github.io/media/law-inherent-scale.png" alt="An icon of a column chart getting larger as it goes to the right and an arrow following along the top of the columns">&lt;/p>
&lt;p>With Azure Functions, scaling just occurs. And remember, scaling is both out and back. It’s not enough to be able to scale out, the service needs to also be able to scale back; &lt;strong>all the way to zero&lt;/strong>. That last part is important as you’ll see when we get to the third and final law.&lt;/p>
&lt;p>The way that Azure Functions accomplishes this is by adding servers as your demand spikes, and removing them as the demand subsides. This includes putting your app back on cold disk if it hasn’t been called for a period of time. It then has to rehydrate the application when the next invocation occurs.&lt;/p>
&lt;p>You can actually watch this happen in realtime by simulating some load on an Azure Functions instance. Watch the GIF below and you can see the number of servers increase as the CPU gets pegged.&lt;/p>
&lt;p>&lt;img src="https://burkeholland.github.io/media/function-scaling-demo.gif" alt="Azure App Insights showing increased traffic and the number of servers increasing as load on the server reaches 100%">.&lt;/p>
&lt;p>What about a PaaS though? Don’t most PaaS’s scale?&lt;/p>
&lt;p>Yes, They do.&lt;/p>
&lt;p>Let’s look at Azure App Service again as an example. App Service can scale out in one of two ways. One way is for you to manually add another App Service instance (B tier for example). This would not be considered “inherent scale” since it does not happen automatically.&lt;/p>
&lt;p>The second way is something called “Auto scaling”. This is where Azure will automatically add new App Service instances for you as the load increases. That &lt;strong>is&lt;/strong> inherent scale. However, you have to scale in chunks - or rather by adding full App Service Plan instances. In other words, you have to add another full B instance to scale out, even if you don’t need the entire amount of that compute. This means that you are paying for compute whether you use it or not. This brings us to the third and final Serverless Law - the “Law of Least Consumption”.&lt;/p>
&lt;h2 id="law-of-least-consumption">Law of Least Consumption&lt;/h2>
&lt;p>The Law of Least Consumption says that you only pay for what you use. Coincidentally, this also everyone’s most favorite law. Money talks. But it doesn’t buy happiness. But it does buy jetski’s and I’ve never seen an unhappy person on a jetski.&lt;/p>
&lt;p>&lt;img src="https://burkeholland.github.io/media/law-least-consumption.png" alt="An icon of a water faucet with the water running">.&lt;/p>
&lt;p>Think about it like this: in your house, or your parents house, or apartment or wherever you happen to live, you probably have running water. But that water doesn’t run all the time. It only runs when you need it. You turn the faucet on to get water, and off when you aren’t using it. By the way, you can now get a faucet that is &lt;a href="https://www.cnet.com/news/delta-to-make-faucets-that-work-with-amazon-alexa/">controlled by Alexa&lt;/a>. Which is just what we need - robots in charge of the water supply.&lt;/p>
&lt;p>Azure Functions is like a water faucet for compute. You only get charged for what you use. That occurs in a few different ways…&lt;/p>
&lt;ol>
&lt;li>&lt;strong>Code storage&lt;/strong> - you pay for the disk space that your code actually occupies on the server&lt;/li>
&lt;li>&lt;strong>Executions&lt;/strong> - you pay per execution of your function&lt;/li>
&lt;li>&lt;strong>Execution time&lt;/strong> - you pay for the amount of compute that your function uses.&lt;/li>
&lt;/ol>
&lt;p>You also receive 1 million free executions a month. That combined with the miniscule cost of storage means that if your Azure Functions don’t get called, you don’t pay anything. This makes a lot of a sense as a customer. Just think of all the compute that we have paid for and wasted all these years! You could be retired already! But probably not because you’d blow all that extra money on jetski’s.&lt;/p>
&lt;p>The cloud can (and should) save us money by being able to target compute by need and not just allocating it in “use it or lose it” buckets.&lt;/p>
&lt;h2 id="applying-the-serverless-laws">Applying the Serverless Laws&lt;/h2>
&lt;p>Now that I have established an irrefutable framework to determine if something is Serverless, we can apply these laws to any technology to determine if it is or is NOT Serverless.&lt;/p>
&lt;h3 id="azure-services-that-are-serverless">Azure Services that are Serverless&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/azure/javascript/tutorial-vscode-static-website-node-01">Azure Static Sites&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://azure.microsoft.com/free/serverless/?WT.mc_id=personal-blog-buhollan">Logic Apps&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/azure/cosmos-db/introduction?WT.mc_id=personal-blog-buhollan">Cosmos DB&lt;/a>
&lt;ul>
&lt;li>Note - Cosmos DB isn’t quite Serverless just yet, but it’s close. It conforms to law 1, but up until recently, you’ve had to buy database bandwidth in chunks which means it did not conform to laws 2 and 3. However, as of Ignite, the team announced “Auto Pilot”. This is a feature which automatically adds throughput as the load requires it, but you still have to pay for a basic allocation. Once Cosmos DB allows you to start from absolute zero, it will comply with all 3 laws and can be considered “Serverless”.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/azure/sql-database/sql-database-serverless?WT.mc_id=personal-blog-buhollan">SQL Server&lt;/a>
&lt;ul>
&lt;li>Believe it or not, SQL Server has a “Serverless” offering.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>The next time someone casually throws out a “Serverless”, see if satisfies the 3 Laws of Serverless. If it does, you can save yourself a “well, actually”. If it doesn’t, just nod and smile. And try to pay attention to the Venn Diagram.&lt;/p></description></item><item><title>GSAP, Webpack and invalid tweens</title><link>https://burkeholland.github.io/posts/invalid-tween/</link><pubDate>Wed, 27 Nov 2019 16:51:54 -0600</pubDate><guid>https://burkeholland.github.io/posts/invalid-tween/</guid><description>&lt;p>Before I forget, I wanted to document for posterity how I lost about 4 hours yesterday to gsap/webpack issue.&lt;/p>
&lt;p>I was working on a Vue project (CLI) with some gsap powered animations that I did not write. Not having written them, I can confess that I have no idea what they are or what they do. Any time I see the word “Tween”, I get flashbacks to actual &lt;em>Flash&lt;/em> timelines and this very visceral feeling that I do not know, nor will I ever, know what I’m doing.&lt;/p>
&lt;p>The application ran fine in development mode. But when I built the thing (&lt;code>npm run build&lt;/code>) and deployed it, none of the animations worked. Because why would something ever work on your machine AND when you deploy it? That wouldn’t be software development at all. That would be cooking. Or carpentry. But the first rule of software development is that it only works for you. This is either because software is hard, or because god hates you.&lt;/p>
&lt;p>Either way, here’s the error you googled for…&lt;/p>
&lt;pre>&lt;code>Invalid visibility tween of visible Missing plugin? gsap.registerPlugin()
&lt;/code>&lt;/pre>
&lt;p>First off, is it just me or is this error message missing some punctuation? Should there be a period after “visible”? Also, “invalid visibility tween of visible”? That’s the most circular 5 words I have ever read. Even now I’m not quite sure what they are trying to say in this error. The last part is kind of helpful - &lt;code>gsap.registerPlugin()&lt;/code>. OK, so it thinks I need to register a plugin to change the visibility of things. Except that there is no plugin in gsap to do that. Like I said, I have no idea what I’m doing, but if the line to animate the visibility looks like this..&lt;/p>
&lt;pre>&lt;code>mounted() {
TweenMax.set(&amp;quot;#thisisfine&amp;quot;, {
visibility: &amp;quot;visible&amp;quot;
});
}
&lt;/code>&lt;/pre>
&lt;p>Where, exactly, is the visibility plugin? And isn’t that something that gsap should just do in it’s base library? If TweenMax can’t change the visibility of something without a plugin, what good is it for?&lt;/p>
&lt;p>This one really stumped me. I noticed that not only visibility, but every single animation in the app was broken. All kinds of errors, all of them roughly the same…&lt;/p>
&lt;pre>&lt;code>Invalid filter tween of none Missing plugin? gsap.registerPlugin()
Invalid fill tween of hsl(+=0%, -=100%, +=0%) Missing plugin? gsap.registerPlugin()
Invalid y tween of -28 Missing plugin? gsap.registerPlugin()
Invalid rotation tween of 10 Missing plugin? gsap.registerPlugin()
Invalid transformOrigin tween of 50% 50% Missing plugin? gsap.registerPlugin()
&lt;/code>&lt;/pre>
&lt;p>Again, all of this works in development.&lt;/p>
&lt;p>I did a lot of Googling on this issue and read a lot of forum posts I didn’t understand. What’s relatively clear here is that somehow, in a production build, Webpack is not including all of the necessary parts of gsap to make this work. It includes them in the development bundle, but not the production one.&lt;/p>
&lt;p>I eventually found &lt;a href="https://greensock.com/forums/topic/21298-premium-plugins-vue-npm-run-build/">this forum post&lt;/a> on the gsap forums about Webpack shaking gsap plugins out during the tree-shaking part of the build process. This happens if you aren’t referencing the plugins anywhere in your code. The suggested fix is to explicitly include the plugin in your code so that Webpack knows that you are in fact going to use it.&lt;/p>
&lt;pre>&lt;code>import MorphSVGPlugin from &amp;quot;gsap/src/uncompressed/plugins/MorphSVGPlugin&amp;quot;;
// You need to reference the plugin somewhere in your code
const plugins = [MorphSVGPlugin];
&lt;/code>&lt;/pre>
&lt;p>But as we already saw, I don’t have that problem. The code I’m working with is importing &lt;code>TweenMax&lt;/code> and using &lt;code>TweenMax&lt;/code>. WebPack should be including that. If we look a the import for gsap, you can see that VS Code does see a “visibility” property on the gsap import.&lt;/p>
&lt;p>&lt;img src="https://burkeholland.github.io/media/vs-code-gsap.png" alt="visibility property on gsap object in VS Code">&lt;/p>
&lt;p>On a hunch, I imported &lt;code>visibility&lt;/code> and then included it as per the forum post.&lt;/p>
&lt;pre>&lt;code>import { TimelineMax, TweenMax, Circ, visibility } from &amp;quot;gsap&amp;quot;;
const plugins = [visibility];
&lt;/code>&lt;/pre>
&lt;p>And, SUCCESS! But not just for the visibility animation, for ALL of them. All of the animations now work.&lt;/p>
&lt;p>I’m not sure why this is. It’s like whatever code allows gsap to animate visibility allows it to do everything else. So including that one property includes what we actually want, which is a functioning gsap.&lt;/p>
&lt;p>In any event, hopefully this post is a quick Google search away and you didn’t have to spend 4 hours on it like I did.&lt;/p></description></item><item><title>Selecting the first item from an array</title><link>https://burkeholland.github.io/posts/select-one-javascript/</link><pubDate>Sun, 17 Nov 2019 17:00:11 -0600</pubDate><guid>https://burkeholland.github.io/posts/select-one-javascript/</guid><description>&lt;p>Sometimes, in life, you just want one of something. Not two. Never two. Just one. Like a toothbrush. Or a flu shot. Or a pug. Dear god, trust me, you do not want more than one pug. It’s like a choir of snoring with flatulance on backup vocals.&lt;/p>
&lt;p>This is common in database queries, too. I mean, the desire to just get one result. Not the flatulance. Although it &lt;em>might&lt;/em> be. I’ve got no data on that and writing queries can be super stressful.&lt;/p>
&lt;p>Applications that act as a form over some sort of data often require the retreiving of just one item so that you can edit that item. Which, according to science, is like 110% of all applications ever.&lt;/p>
&lt;p>I recently built a small application with &lt;a href="https://www.npmjs.com/package/@azure/cosmos">Cosmos DB&lt;/a>, and I quickly ran into a situation where I needed to select one item. Specifically, I have a database structure that looks like this…&lt;/p>
&lt;pre>&lt;code>{
productId: 1,
productName: &amp;quot;Hammer&amp;quot;,
productDescription: &amp;quot;a tool consisting of a weighted \&amp;quot;head\&amp;quot; fixed to a long handle that is swung to deliver a swift and brutal impact to the thumb.&amp;quot;
brand: {
brandId: 10,
brandName: &amp;quot;Acme&amp;quot;,
}
}
&lt;/code>&lt;/pre>
&lt;p>If we wanted to get just the Acme thumb smash…..er…..hammer, then we could write a select statement that looks like the following…&lt;/p>
&lt;pre>&lt;code>SELECT *
FROM products p
WHERE p.name = &amp;quot;Hammer&amp;quot; AND p.brand.name = &amp;quot;Acme&amp;quot;
&lt;/code>&lt;/pre>
&lt;p>Executing this query in Cosmos DB looks something like this…&lt;/p>
&lt;pre>&lt;code>async function getProduct(productName: string, brandName: string) {
const query = `SELECT TOP 1 *
FROM products p
WHERE p.productName = &amp;quot;${productName}&amp;quot;
AND p.brand.brandName = &amp;quot;${brandName}&amp;quot;`;
const result = await collection.items.query(query).fetchNext();
return result.resources[0];
}
getProduct(&amp;quot;Hammer&amp;quot;, &amp;quot;Acme&amp;quot;).then(product =&amp;gt; {
console.log(JSON.stringify(product));
});
&lt;/code>&lt;/pre>
&lt;blockquote>
&lt;p>Note that “SELECT Top 1 _” is preferred over “SELECT _” so you don’t return more data than you intend. And “SELECT p.ANYTHING_AT_ALL” is preferrable to “SELECT *” because your document structure may not always be the same in a NoSQL database because that’s the world we live in now.&lt;/p>
&lt;/blockquote>
&lt;p>Assuming that the brand name and product name together constitute a unique key, we should only ever get one result back. The Cosmos DB JavaScript SDK always returns an array for queries, even if there is only one item inside. To get that item, we can just grab the zero-index item from the &lt;code>resources&lt;/code> object, which is what’s going on in that gorgeous code block above composed by yours truly.&lt;/p>
&lt;p>The problem is that this returns &lt;code>undefined&lt;/code> if there is no result. We could check for that and return en empty object easily enough…&lt;/p>
&lt;pre>&lt;code>return result.resources[0] || {};
&lt;/code>&lt;/pre>
&lt;p>But…”yuck”. I don’t know what it is about array notation, but it always feels like I’m doing it wrong. Like I’m cheating by using the array index. I think this is because I’m explicitly asking for something that, much like god, may or may not exist. If it does exist, everything is fine. If it doesn’t, the only way to find out is the hard way.&lt;/p>
&lt;p>Array notation isn’t bad per say, but I generally try and stay away from it because it’s the best way to smash your face on “undefined is not a function” if you use it with objects.&lt;/p>
&lt;p>To feel less dirty, we could instead use the array “shift” method. This gives us the first object in the array or &lt;code>undefined&lt;/code>.&lt;/p>
&lt;pre>&lt;code>return result.resources.shift() || {};
&lt;/code>&lt;/pre>
&lt;p>But that also alters the original array, which we might not want. Like if we were going to use that same response again for another operation. I know you think you won’t. You always think you won’t. But then, eventually, you do and by the time you do you’ve forgotten all about this whole scenario because at least a year has passed, you’ve had a child, you’ve moved twice because you don’t get along with your neighbors and your wife has acquired two pugs.&lt;/p>
&lt;p>It’s generally not a good idea to go around modifying collections unless you specifically want to do that. Insert esoteric HN article about immutability.&lt;/p>
&lt;p>Instead we could use &lt;code>find&lt;/code>, which will leave the original &lt;code>resources&lt;/code> array intact…&lt;/p>
&lt;pre>&lt;code>return result.resources.find(x =&amp;gt; x) || {};
&lt;/code>&lt;/pre>
&lt;p>Cosmos DB enginner and JavaScript trickster &lt;a href="https://twitter.com/southpolesteve">Steve Faulkner&lt;/a> pointed out that you could also just destructure the array. But we can’t do that in a return statement for reasons that the JavaScript gods have not seen fit to reveal. So we would need two lines. Also, we can’t do a default value on the destructuring, so we would have to do it on the return.&lt;/p>
&lt;pre>&lt;code>const [item] = result.resources;
return item || {};
&lt;/code>&lt;/pre>
&lt;p>He also pointed out to me that the common denominator in all my failed neighbor relationships might be me.&lt;/p>
&lt;p>At this point, we just have to ask, “Which of these is best”? We don’t have to ask that, but we probably should given this is a blog post and it needs a conclusion.&lt;/p>
&lt;p>In my opinion, as much as I hate to admit it, it’s the line we started with. While array notation might seem dirty, in this instance, it simply makes the most sense and most clearly articulates what the code does.&lt;/p>
&lt;pre>&lt;code>return result.resources[0] || {};
&lt;/code>&lt;/pre>
&lt;p>It’s also not a problem to use array notation here because we are in fact working with an array. The whole reason I was trying to avoid that situation in the first place is because I was looking for a solution to a problem that JavaScript just doesn’t have.&lt;/p>
&lt;h2 id="a-solution-without-a-problem">A solution without a problem&lt;/h2>
&lt;p>If you have used C# before, you will be familiar with LINQ. You will also be very familiar with LINQ’s &lt;code>firstOrDefault&lt;/code> or &lt;code>singleOrDefault&lt;/code> methods. These methods return either the first result from the query, or an empty object of the query return type. LINQ doesn’t exist for JavaScript (that’s a &lt;a href="https://github.com/mihaifm/linq">lie&lt;/a>) and there is a reason for that: We don’t need it.&lt;/p>
&lt;p>The &lt;code>firstOrDefault&lt;/code> and &lt;code>singleOrDefault&lt;/code> methods are needed for C# because it is a typed language. You can’t just return an object. You either have to get a result, or you need to get a null object of a certain type. In JavaScript, we don’t care about types (very much). So it’s easy enough for us to check and see if something is simply there and then return an empty object if it is not. We don’t even have to do that much. We can just use the result type later in our code if it’s defined at all.&lt;/p>
&lt;pre>&lt;code>const product = await db.getProduct(&amp;quot;Hammer&amp;quot;, &amp;quot;Acme&amp;quot;);
if (product) {
product.description = ...
}
else {
console.log(&amp;quot;Unable to find a(n) %s %s&amp;quot;, &amp;quot;Acme&amp;quot;, &amp;quot;Hammer&amp;quot;);
}
&lt;/code>&lt;/pre>
&lt;p>The moral of this story is that sometimes your first instinct is the right one. Or, it’s not. Either way, you won’t know until you write a blog post.&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/azure/cosmos-db/create-sql-api-nodejs">Connect to and query data from Azure Cosmos DB&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://ardalis.com/javascript-es6-linq-equivalents">Nifty article from Steve Smith on mapping JavaScript array methods to LINQ methods&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Deploying a Nuxt App to Azure</title><link>https://burkeholland.github.io/posts/thank-you-nuxt/</link><pubDate>Wed, 05 Jun 2019 17:04:42 -0600</pubDate><guid>https://burkeholland.github.io/posts/thank-you-nuxt/</guid><description>&lt;summary>Summary: Nuxt apps with “server-side rendering” require a Node server, so you need to deploy them to Azure App Service. If you are using Nuxt apps in SPA mode, you can (and should) deploy them to Azure Storage.
&lt;p>Check out the links below for more details…&lt;/p>
&lt;figure>&lt;img class="azure-icon" src="https://burkeholland.github.io/media/Icon-compute-35-App-Services.svg" />&lt;a href="https://code.visualstudio.com/tutorials/app-service-extension/getting-started?WT.mc_id=personal-blog-buhollan">Deploy to Azure App Service&lt;/a>&lt;/figure>
&lt;figure>&lt;img class="azure-icon" src="https://burkeholland.github.io/media/Icon-storage-86-Storage-Accounts.svg"/>&lt;a href="https://code.visualstudio.com/tutorials/static-website/getting-started?WT.mc_id=personal-blog-buhollan">Deploy a static website to Azure&lt;/a>&lt;/figure>
&lt;/summary>
&lt;p>&lt;/p>
&lt;p>Ariana Grande once said, “One taught me patience. And one taught me pain”. She was talking about her ex’s. I’m here today to talk to you about Nuxt’s.&lt;/p>
&lt;p>Nuxt’s? Nuxt’is? Nuxt’ises?&lt;/p>
&lt;h2 id="what-is-nuxtanyway">What is Nuxt anyway?&lt;/h2>
&lt;p>&lt;a href="https://nuxtjs.org/">Nuxt&lt;/a> is “the VueJS framework”. That’s what it says on their website and why would they lie.&lt;/p>
&lt;p>It’s kinda hard to nail down exactly what Nuxt does, because it does so much. It will automatically setup routing based on your folder structure. It will automatically do code splitting for static sites. It will automatically cause someone to write a blog post with a few too many uses of the word “automatically:“.&lt;/p>
&lt;p>But it’s probably best known as the way that you do server-side rendering with Vue.&lt;/p>
&lt;h2 id="server-side-vue">Server-side Vue&lt;/h2>
&lt;p>Vue is a JavaScript framework. Which means that the code you write is executed in the browser at runtime. But a few years ago, someone smart realized that we can execute JavaScript on the server with Node, so we should be able to run and compile JavaScript frameworks on the server. And they called it, “Isomorphic JavaScript”.&lt;/p>
&lt;p>I still don’t know what that means. Fortunately, it was renamed to “Universal JavaScript”. Vue’s primary value proposition is that it enables developers to build these “Universal Applications”. It does a lot more than that, but that’s primarily what it’s known for. Kind of like John Krasinski is Jack Ryan, but in a much more real sense, he is and always will be &lt;a href="https://en.wikipedia.org/wiki/Jim_Halpert">Jim Halpert&lt;/a>.&lt;/p>
&lt;p>It’s hard to understand Universal JavaScript without seeing something in action, so let’s build something pointless.&lt;/p>
&lt;h2 id="a-pointless-demo">A pointless demo&lt;/h2>
&lt;p>My sample app is a single page with one XMLHTTPRequest (XHR) which pulls some fake images in from the JSON placeholder API. I was expecting better fake images than this, but I suppose you can’t complain about free. Like when my sister-in-law rented a margarita machine and then made them too weak. “Listen, thanks for the free alcohol, but I am disappointed.”&lt;/p>
&lt;p>&lt;img src="https://cdn-images-1.medium.com/max/1600/0*7gaMmL0HlfVX9vZf.png" alt="">&lt;/p>
&lt;p>Here’s the entirety of the code used to make this page.&lt;/p>
&lt;pre>&lt;code>&amp;lt;template&amp;gt;
&amp;lt;div class=&amp;quot;section&amp;quot;&amp;gt;
&amp;lt;h1 class=&amp;quot;is-size-1&amp;quot;&amp;gt;Photos&amp;lt;/h1&amp;gt;
&amp;lt;div class=&amp;quot;columns is-multiline&amp;quot;&amp;gt;
&amp;lt;div
v-for=&amp;quot;photo in photos&amp;quot;
:key=&amp;quot;photo.id&amp;quot;
class=&amp;quot;column is-one-quarter&amp;quot;&amp;gt;
&amp;lt;div class=&amp;quot;card photo&amp;quot;&amp;gt;
&amp;lt;div class=&amp;quot;card-image&amp;quot;&amp;gt;
&amp;lt;figure class=&amp;quot;image&amp;quot;&amp;gt;
&amp;lt;img :src=&amp;quot;photo.url&amp;quot; alt=&amp;quot;photo.title&amp;quot; /&amp;gt;
&amp;lt;/figure&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;div class=&amp;quot;card-content&amp;quot;&amp;gt;
&amp;lt;div class=&amp;quot;content&amp;quot;&amp;gt;
&amp;lt;p&amp;gt;{{ photo.title }}&amp;lt;/p&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;/template&amp;gt;
&amp;lt;script&amp;gt;
export default {
async asyncData({ $axios }) {
const { data } = await $axios.get(
'https://jsonplaceholder.typicode.com/photos?_limit=100'
)
return { photos: data }
}
}
&amp;lt;/script&amp;gt;
&amp;lt;style&amp;gt;
.card.photo {
height: 100%;
}
&amp;lt;/style&amp;gt;
&lt;/code>&lt;/pre>
&lt;p>Not super exciting, but enough to test out Nuxt’s value proposition of rendering apps on the server. On line 29 there is an HTTP call to the endpoint made with axios. Even though this code is in the component, Nuxt is going to make that call and compile this template on the server. So the page we get will already have all of the markup in it.&lt;/p>
&lt;p>But how do we know for sure that Nuxt is actually doing this? What if it’s just lying to us? How can I ever trust anyone again after &lt;a href="https://www.theregister.co.uk/2016/03/23/npm_left_pad_chaos/">left-pad&lt;/a>?&lt;/p>
&lt;p>The easiest way is to just right-click the page and “View Source”. View Source shows you what the page looks like when it was requested from the server. That is before any JavaScript has a chance to mutilate it. I mean mutate it.&lt;/p>
&lt;p>&lt;img src="https://miro.medium.com/max/2784/0*quP9zI62tcajdDpr.png" alt="">&lt;/p>
&lt;p>Yep - all of the markup is definitely there. And it ain’t pretty either. But that’s OK because it’s minified or something. And smaller is always better on the web. &lt;a href="https://css-tricks.com/how-to-increase-your-page-size-by-1500-with-webpack-and-vue/">OR IS IT&lt;/a>.&lt;/p>
&lt;p>You can also open the dev tools and just look for an XHR. It will be conspicuously absent.&lt;/p>
&lt;p>&lt;img src="https://miro.medium.com/max/2784/0*FVNiYW--Kj67z5PS.png" alt="">&lt;/p>
&lt;p>I didn’t have too much trouble getting this far. Nuxt is….different than a standard Vue application, but it’s not a brick to teeth. It’s relatively easy to just scaffold out a new app and then read the first paragraph of the “Getting Started” page and assume that you know everything already.&lt;/p>
&lt;p>Then I went to deploy it.&lt;/p>
&lt;h2 id="deploying-nuxtapps">Deploying Nuxt apps&lt;/h2>
&lt;p>Since Nuxt is rendering things on the server, Nuxt apps require a server. A node server to put too fine a point on it. I’m using Azure, so that means &lt;a href="https://code.visualstudio.com/tutorials/app-service-extension/getting-started?WT.mc_id=personal-blog-buhollan">AppService&lt;/a>. Vue apps that are single-page applications can be hosted on &lt;a href="https://code.visualstudio.com/tutorials/static-website/getting-started?WT.mc_id=personal-blog-buhollan">Azure Storage&lt;/a>.&lt;/p>
&lt;p>Before the app can be run, it has to be built. Ideally, we want this to happen on the server. The preferred workflow is…&lt;/p>
&lt;ul>
&lt;li>Make a change&lt;/li>
&lt;li>Check into Github&lt;/li>
&lt;li>Azure pulls in code automatically&lt;/li>
&lt;li>Azure performs build&lt;/li>
&lt;li>Azure starts the site&lt;/li>
&lt;/ul>
&lt;p>This workflow lets you focus on writing code, not deploying things. You just check them into source control and your site is magically updated. This is kind of like the simplest possible form of DevOps.&lt;/p>
&lt;p>To set up a workflow like this in Azure, I need to first decide if I’m more of a Windows guy, or more of a Linux guy. Azure supports both operating systems, and the one that you choose matters a whole lot. Just wait.&lt;/p>
&lt;p>Let’s start with Linux. It’s important that we start with Linux because Linux is the preferred way to run Node applications in Azure. I bolded that statement because it’s important. It means that the effort to improve the Node experience in Azure is focused around Linux.&lt;/p>
&lt;h2 id="deploying-tolinux">Deploying to Linux&lt;/h2>
&lt;p>Running a Nuxt application on AppService for Linux “just works” thanks to a new build tool in Azure called “Oryx”. In fact, Oryx just rolled out this month. Welcome to the world, Oryx! Sorry about 2019.&lt;/p>
&lt;p>&lt;img src="https://miro.medium.com/max/2600/0*FsNsKCMuU_6r6Tfe.png" alt="">&lt;/p>
&lt;p>All it takes to deploy and build this thing on Azure, is to configure the site for Git or GitHub deployment and check the project into the repo.&lt;/p>
&lt;p>&lt;img src="https://miro.medium.com/max/1392/0*cDgYe1sVFNHR13Zm.png" alt="">&lt;/p>
&lt;p>Oryx will pull in the code, run an npm install and then execute npm run build. The Git logs will show that a Nuxt build did occur.&lt;/p>
&lt;p>&lt;img src="https://miro.medium.com/max/2600/0*ey-IoljeCrcp32l1.png" alt="">&lt;/p>
&lt;p>Browse to the site and…&lt;/p>
&lt;p>&lt;img src="https://miro.medium.com/max/2600/0*lyVy7wWpY044J3dx.png" alt="">&lt;/p>
&lt;p>It takes a LONG time for Azure to return this error and I’ve been working with Azure long enough to know that when this happens, it’s probably because Azure cannot bind to a port or address. That happens if the app is trying to bind to some hard-coded address (like localhost) or some hard-coded port (like 3000).&lt;/p>
&lt;p>A lot of hosting providers have this issue. This included sites on Heroku and anywhere else that uses containers to host apps like Azure does. To fix it, the Nuxt docs say to include a section in the nuxt.config.js that binds to 0.0.0.0.&lt;/p>
&lt;pre>&lt;code>server: {
host: '0.0.0.0'
}
&lt;/code>&lt;/pre>
&lt;p>And…&lt;/p>
&lt;p>&lt;img src="https://miro.medium.com/max/2600/0*fFFcsLVb3AdMJJNO.png" alt="">&lt;/p>
&lt;p>Excellent! Not too bad. The host setting is really the only thing that might trip you up here.&lt;/p>
&lt;p>&lt;strong>Bonus tip&lt;/strong>: you can speed up the whole build process quite a bit by using yarn instead of npm. Azure caches the top yarn modules so yarn install is going to be enormously faster than npm install.&lt;/p>
&lt;p>That’s Linux. Now let’s talk about Windows.&lt;/p>
&lt;h2 id="deploying-towindows">Deploying To Windows&lt;/h2>
&lt;p>Deploying to Windows is quite a bit more….interesting. There is no Oryx build tool for Windows. Instead, you get something called “Kudu”.&lt;/p>
&lt;p>By default, Kudu doesn’t build anything. You have to include a .deployment file with the right setting to get it to perform a build. That just happens to be the SCM_DO_BUILD_DURING_DEPLOYMENT setting.&lt;/p>
&lt;pre>&lt;code>[config]
SCM_DO_BUILD_DURING_DEPLOYMENT=true
&lt;/code>&lt;/pre>
&lt;p>The problem is that your definition of a build and Kudu’s definition of a build are probably not the same. When I say build, I mean npm install and then npm run build. Kudu’s definition stops at npm install. But since Kudu is already running an npm install, we can trick it into also running the build command by just making it a postinstall hook.&lt;/p>
&lt;pre>&lt;code>&amp;quot;postinstall&amp;quot;: &amp;quot;npm run build&amp;quot;
&lt;/code>&lt;/pre>
&lt;p>It works! Wait. Kind of.&lt;/p>
&lt;p>&lt;img src="https://miro.medium.com/max/1392/0*9ySqMlUopJGE9oJI.png" alt="">&lt;/p>
&lt;p>Well, it worked in so much as Kudu did run the postinstall hook, but the build fails. And it fails because function is an unexpected token. Anytime you see “unexpected token” as an error, the problem is likely because your Node version is wrong. I scrolled back up through the logs and saw this…&lt;/p>
&lt;p>&lt;img src="https://miro.medium.com/max/1392/0*_uED5o2xWwhIL83N.png" alt="">&lt;/p>
&lt;p>My guess is Node 6.9.1 doesn’t support async functions.&lt;/p>
&lt;p>&lt;img src="https://miro.medium.com/max/1392/0*whhi1gg9RW2I-iHd.png" alt="">&lt;/p>
&lt;p>Nope. Looks like version 7.10.1 is the minimum for that. To stay safe, let’s choose the highest supported version of Node in Azure, which at the time of this writing, is 10.15.2. The most reliable way to set the &lt;code>WEBSITE_DEFAULT_NODE_VERSION&lt;/code> in Azure is to do it via an App Setting.&lt;/p>
&lt;p>&lt;img src="https://miro.medium.com/max/1392/0*Pnf75E2ErbA9rKCX.png" alt="">&lt;/p>
&lt;p>SUCCESS!&lt;/p>
&lt;p>&lt;img src="https://miro.medium.com/max/1392/0*OMHwK7RnSCs6BRO0.png" alt="">&lt;/p>
&lt;p>Now we’ll just browse to the site….&lt;/p>
&lt;p>&lt;img src="https://miro.medium.com/max/1392/0*omyORxUG6LZq6tI3.png" alt="">&lt;/p>
&lt;p>What’s the word when something should work, but it doesn’t work and you don’t know why? Oh yeah, “programming”.&lt;/p>
&lt;p>Scrolling back up through the output reveals this…&lt;/p>
&lt;p>&lt;img src="https://miro.medium.com/max/1392/0*CW88bWnlqBMRU3wQ.png" alt="">&lt;/p>
&lt;p>Well, it’s not an invalid startup command, but Kudu is expecting something in the format of node entry-point. There is an interesting line below that one that says…&lt;/p>
&lt;p>“Missing server.js/app.js files, web.config is not generated”&lt;/p>
&lt;p>What’s happening here is Windows uses IISNode to run the application. IISNode requires a web.config to set the entry point and root directory. If you have an app.js or serverjs file in the root of your app, Kudu will use that file to automatically generate a web.config.&lt;/p>
&lt;p>So I added a server.js file to the root of my project that just required in my actual startup file.&lt;/p>
&lt;pre>&lt;code>require('./server/index.js');
&lt;/code>&lt;/pre>
&lt;p>Redeploy and…&lt;/p>
&lt;p>&lt;img src="https://miro.medium.com/max/1392/0*bWHIKki05mhHVZXV.png" alt="">&lt;/p>
&lt;p>Not terrible, but not terribly intuitive either. You don’t know what you don’t know. And if you didn’t know, now you know.&lt;/p>
&lt;h2 id="look-what-you-taughtme">Look what you taught me&lt;/h2>
&lt;p>I’ll be honest, figuring out the Windows part of this thing was no fun. Patience and pain. That said, I do feel like I understand Azure AppService for Windows way more than I ever thought that I would. At least enough to write a blog post.&lt;/p>
&lt;p>Oryx is new, and it’s a much-welcomed improvement. It works the way that I would expect it to, which is kinda all we’re really asking for as developers. It’s like the Dyson guy used to say…&lt;/p>
&lt;blockquote>
&lt;div>I just think that things should work&lt;/div>
&lt;p>&lt;cite>-The Dyson Vacuum Cleaner Guy&lt;/cite>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;a href="https://github.com/burkeholland/nuxt-appservice-windows">Sample application from this article&lt;/a>&lt;/p></description></item><item><title>This is how to easily deploy a static site to Azure</title><link>https://burkeholland.github.io/posts/static-site-azure/</link><pubDate>Thu, 30 May 2019 08:36:49 -0600</pubDate><guid>https://burkeholland.github.io/posts/static-site-azure/</guid><description>&lt;p>Over the weekend I bought my first new vehicle ever: A red moped. That was the only thing available at my price point.&lt;/p>
&lt;p>&lt;img src="https://miro.medium.com/max/1000/1*igNXrT_-JvgxJSeJ745Owg.jpeg" alt="">&lt;/p>
&lt;p>What a glorious thing it is! The wind whips over your body at a stunning 35 mph and you are alone with your thoughts. You ponder the finer points of the universe: existential questions like, “Do I look stupid on this thing”, “How many bugs can you eat before you die” and “How many ways can I deploy a static site to Azure”?&lt;/p>
&lt;h2 id="whats-a-static-site-moped-boy">What’s a static site, moped boy?&lt;/h2>
&lt;p>Good question. But can we not call me “moped boy”? I mean it’s got 150 CC’s. I can do like 55. Downhill with the wind.&lt;/p>
&lt;p>Frameworks like PHP, ASP.NET and Django assemble pages on the fly. When a site is requested, the server performs some queries or operations, assembles the markup and sends a “page” back to you.&lt;/p>
&lt;p>&lt;img src="https://miro.medium.com/max/600/1*69aS6OhjDU3RBeSRqXiaFA.png" alt="">&lt;/p>
&lt;p>A “static site”, is any site that is not using a server-side framework. It is just HTML, CSS and JavaScript. These days most static sites are some form of single page application built with Angular, React or Vue (alphabetical order, breathe deeply). I think I’m supposed to include Svelte in that list now too.&lt;/p>
&lt;p>&lt;img src="https://miro.medium.com/max/600/1*sar590LUigydRl6LkIqU7Q.png" alt="">&lt;/p>
&lt;p>I’m not sure why I drew my servers in such a bad mood. I think it’s because that’s how I would feel if I was a server. Thankless job. Nobody cares until you go down and then everyone is mad you.&lt;/p>
&lt;p>“So this article is about how to host an index.html file? Really?”.&lt;/p>
&lt;p>NO. I mean, kind of. Actually, yes.&lt;/p>
&lt;h2 id="azure-storage">Azure Storage&lt;/h2>
&lt;p>&lt;a href="https://docs.microsoft.com/en-us/azure/storage/blobs/storage-blob-static-website?WT.mc_id=personal-medium-buhollan">Azure Storage&lt;/a> is specifically designed to serve files as quickly as possible. Static sites are just files. And because God loves you and wants you to be happy, there is VS Code. And because Microsoft loves you, there is an &lt;a href="https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-azurestorage&amp;amp;WT.mc_id=personal-medium-buhollan">Azure Storage extension&lt;/a>.&lt;/p>
&lt;p>Once it’s installed, you create a storage account. That’s pretty straightforward and quick. Short enough to fit in this GIF.&lt;/p>
&lt;p>&lt;img src="https://miro.medium.com/max/1280/1*Py8u-X-STzMXvL_YKOE1Iw.gif" alt="">&lt;/p>
&lt;p>&lt;a href="https://twitter.com/jeffhollan">Jeff Hollan&lt;/a> from the Azure Functions team had a cool tweet the other day about naming temporary Resource Groups with “deleteme” and then having a PowerShell function that deletes them every day. This way you can play around and not end up with a bill you weren’t expecting.&lt;/p>
&lt;div class="twitter-tweet twitter-tweet-rendered" style="display: flex; max-width: 550px; width: 100%; margin-top: 10px; margin-bottom: 10px;">&lt;iframe id="twitter-widget-0" scrolling="no" frameborder="0" allowtransparency="true" allowfullscreen="true" class="" style="position: static; visibility: visible; width: 550px; height: 580px; display: block; flex-grow: 1;" title="Twitter Tweet" src="https://platform.twitter.com/embed/index.html?dnt=false&amp;amp;embedId=twitter-widget-0&amp;amp;frame=false&amp;amp;hideCard=false&amp;amp;hideThread=false&amp;amp;id=1132774507821748224&amp;amp;lang=en&amp;amp;origin=https%3A%2F%2Fburkeholland.github.io%2Fposts%2Fstatic-site-azure%2F&amp;amp;theme=light&amp;amp;widgetsVersion=ed20a2b%3A1601588405575&amp;amp;width=550px" data-tweet-id="1132774507821748224">&lt;/iframe>&lt;/div>
&lt;p>The account will get created and show up in the sidebar under the Storage Extension.&lt;/p>
&lt;p>&lt;img src="https://miro.medium.com/max/1392/1*6IXOSL6kZcJ3GMizLC3u7g.png" alt="">&lt;/p>
&lt;p>Azure Storage is for serving files, so we need to tell it that we want it to serve our files like a web server. To do that, open the Command Palette and select “Configure static website”.&lt;/p>
&lt;p>&lt;img src="https://miro.medium.com/max/1280/1*OB5z_9Wv3mgy2XMrkN76dw.gif" alt="">&lt;/p>
&lt;p>It asks what the “index.html” page is. That’s usually just “index.html”. Then it asks for a 404 page. Since we have a single page application, we’re going to direct all traffic back to the “index.html” page and handle routing ourselves.&lt;/p>
&lt;p>Now we just need to right-click our “dist” or “build” or whatever folder contains the build assets that Webpack made via whatever it is that Webpack does (nobody but &lt;a href="https://twitter.com/TheLarkInn">Sean Larkin&lt;/a> knows) and select “Deploy To Static Website”. In this case, I’m deploying a site that is written in Vue.&lt;/p>
&lt;p>&lt;img src="https://miro.medium.com/max/1281/1*yGN41vTumZskHeRHOoKYpA.png" alt="">&lt;/p>
&lt;p>And that’s it. The extension will give you a prompt to browse the website. You will marvel at your own productivity and consider having pizza for a third night in a row. Go ahead. Treat yourself.&lt;/p>
&lt;p>&lt;img src="https://miro.medium.com/max/1392/1*153NnRgd61tH9U4URyjCNg.png" alt="">&lt;/p>
&lt;p>Azure Storage is the preferred method for hosting a static site. Here’s why…&lt;/p>
&lt;ul>
&lt;li>It’s Simple&lt;/li>
&lt;li>It’s Fast&lt;/li>
&lt;li>It’s Cheap — 20 cents per gig of storage per month / 8 cents per gig outbound data transfer, but you get the first 5 gigs every month free.&lt;/li>
&lt;li>It automatically scales&lt;/li>
&lt;li>IT’S SERVERLESS. I used a buzzword. You have to be convinced now.&lt;/li>
&lt;/ul>
&lt;h2 id="azure-app-service">Azure App Service&lt;/h2>
&lt;p>&lt;a href="https://docs.microsoft.com/en-us/azure/app-service/?WT.mc_id=personal-medium-buhollan">App Service&lt;/a> is Azure’s Platform as a Service or “PaaS”. It’s different from Storage because it provides a runtime for your server-side projects. If you had an ASP.NET application, you would run it in App Service. You can’t run it in Azure Storage because Storage doesn’t know how to run applications.&lt;/p>
&lt;p>You can host a static site in App Service, but because it’s designed for much more powerful server-side workflows, We need to sort of “finesse” things a bit.&lt;/p>
&lt;p>Kid gloves, people.&lt;/p>
&lt;p>I’m going to do everything via VS Code because that’s how I want to do everything in my life. I would happily take a VS Code extension for Outlook. Free startup idea right there.&lt;/p>
&lt;p>&lt;img src="https://miro.medium.com/max/2416/1*Gvs5rpNLh3I6hTMApKe4PQ.png" alt="">&lt;/p>
&lt;p>When you set up a new App Service instance, you can choose from either Linux or Windows hosting in App Service, so I’m going to cover how to publish your static site to both. And of course, we’re going to do it all from VS Code with the &lt;a href="https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-azureappservice&amp;amp;WT.mc_id=personal-medium-buhollan">App Service extension&lt;/a>.&lt;/p>
&lt;h3 id="linux">Linux&lt;/h3>
&lt;p>Let’s set up the new site via the VS Code extension.&lt;/p>
&lt;p>&lt;img src="https://miro.medium.com/max/2560/1*YDJJsQI1h55O-yHkZUFQ_A.gif" alt="">&lt;/p>
&lt;p>Note that I selected “LTS” as my Node version. LTS on Azure means that you get whatever the highest Node version that Azure supports is. Whenever Azure supports a newer version, your project will automatically get updated.&lt;/p>
&lt;p>App Service for Linux does not come with a baked-in web server. So you can’t just chuck your static site in there. Azure is gonna be like, “I don’t know what you want from me”. And you’ll be like, “I want you to run this site”. And Azure will be like “I don’t know how”. And you’ll feel like nobody understands you.&lt;/p>
&lt;p>To fix that, we need to send a web server up with our files. A simple way to do this is to use the &lt;a href="https://www.npmjs.com/package/serve">serve&lt;/a> package from npm.&lt;/p>
&lt;p>You also need some way to tell Azure to start “serve”. You could do that by putting a second &lt;code>package.json&lt;/code> file in your “dist” folder. But two package JSON’s is kinda ew. Not very ew, but definitely slightly ew.&lt;/p>
&lt;p>Instead, we can leverage the fact that Azure bakes &lt;a href="http://pm2.keymetrics.io/">pm2&lt;/a> into every Node.js app in App Service. pm2 is a process manager for Node, and you can start apps with it. That means that if we include the right kind of file in our project, Azure will see it and use pm2 to start our project. Here’s a video that explains pm2 in a bit more detail just in case you’re new to the pm2 crew.&lt;/p>
&lt;iframe width="560" height="315" src="https://www.youtube.com/embed/hYdSfH-0tVI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="">&lt;/iframe>
&lt;p>The file pm2 looks for is called ecoysystem.config.js. In that file, tell pm2 to start “serve”. Passing the -s flag makes “serve” route every request it can’t find back to index.html. We want that because we have a SPA and we are handling all the routing on the client.&lt;/p>
&lt;pre>&lt;code>module.exports = {
apps: [
{
script: &amp;quot;npx serve -s&amp;quot;
}
]
};
&lt;/code>&lt;/pre>
&lt;p>I’m also using &lt;code>npx&lt;/code> because that keeps me from having to ssh into my instance and install “serve” globally.&lt;/p>
&lt;p>Drop this file in the “dist” folder. Then deploy the “dist” folder to Azure. Boom — there is your static site. It took me 2 years here at Microsoft to figure out that simple solution. If Vue is your jam, I created a &lt;a href="https://github.com/burkeholland/dead-simple-vue-azure">simple Github repo&lt;/a> just for you.&lt;/p>
&lt;p>Now I realize that you probably don’t wanna right-click and deploy for the rest of your natural life, so instead of doing that, you can use App Service’s ability to build your project for you. Building With App Service for Linux&lt;/p>
&lt;p>If you enable Local Git or GitHub deployment on your site and then check in, Azure will pull the code, run npm install, and then automatically run npm run build. In this case, you would want the ecosystem.config.js file to be at the root and point to the “dist” folder that gets created by the build step.&lt;/p>
&lt;pre>&lt;code>module.exports = {
apps: [
{
script: &amp;quot;npx serve dist -s&amp;quot;
}
]
};
&lt;/code>&lt;/pre>
&lt;p>Now your build is taking place on Azure. All you need to do is check your code into Git — Which, let’s be honest, is hard enough as it is. It’s nice that the rest of this “just works”.&lt;/p>
&lt;blockquote>
&lt;p>Note that at the time of this writing, you need to choose Node 10.14.1 in order for the automatic builds to kick in. This should be fixed in LTS shortly (like in a couple of weeks) so I’m writing it that way to keep it fresh.&lt;/p>
&lt;/blockquote>
&lt;h3 id="windows">Windows&lt;/h3>
&lt;p>On Windows, your site kind of just works. Kind of. This is because Windows for Node.js apps in App Service includes Internet Information Services (IIS), which is perfectly fine with serving up some static files. Here’s a Windows instance of my app where all I did was deploy the “dist” folder.&lt;/p>
&lt;p>&lt;img src="https://miro.medium.com/max/2784/1*tYRiq9ZPaojmrAossVw7HA.png" alt="">&lt;/p>
&lt;p>Amazing! But — there is a problem here. You can’t deep link to your app. So if you tried to go the theurlist.com/build2019 (which is a valid route), you would get this…&lt;/p>
&lt;p>&lt;img src="https://miro.medium.com/max/2784/1*YNFHYjl3YdFVaoDU5lWwow.png" alt="">&lt;/p>
&lt;p>This is because IIS is looking for “theurlist.com/build2019/index.html” — which does not exist. We need to tell IIS to just route any and all traffic to “index.html”. To do that, we need to add a web.config to the “dist” folder. Inside, define a single routing rule to catch all traffic.&lt;/p>
&lt;pre>&lt;code>&amp;lt;?xml version=&amp;quot;1.0&amp;quot;?&amp;gt;
&amp;lt;configuration&amp;gt;
&amp;lt;system.webServer&amp;gt;
&amp;lt;rewrite&amp;gt;
&amp;lt;rules&amp;gt;
&amp;lt;rule name=&amp;quot;Vue&amp;quot; stopProcessing=&amp;quot;true&amp;quot;&amp;gt;
&amp;lt;match url=&amp;quot;.*&amp;quot; /&amp;gt;
&amp;lt;conditions logicalGrouping=&amp;quot;MatchAll&amp;quot;&amp;gt;
&amp;lt;add input=&amp;quot;{REQUEST_FILENAME}&amp;quot; matchType=&amp;quot;IsFile&amp;quot; negate=&amp;quot;true&amp;quot; /&amp;gt;
&amp;lt;/conditions&amp;gt;
&amp;lt;action type=&amp;quot;Rewrite&amp;quot; url=&amp;quot;/&amp;quot; /&amp;gt;
&amp;lt;/rule&amp;gt;
&amp;lt;/rules&amp;gt;
&amp;lt;/rewrite&amp;gt;
&amp;lt;/system.webServer&amp;gt;
&amp;lt;/configuration&amp;gt;
&lt;/code>&lt;/pre>
&lt;p>As before, push the “dist” folder into Azure. Note that the automatic builds that we have on Linux do not work for Windows.&lt;/p>
&lt;h3 id="azure-web-app-for-containers">Azure Web App for Containers&lt;/h3>
&lt;p>Azure App Service actually uses containers under the covers for every site — even when you are just deploying your files. For that reason, you can also just deploy a container to App Service.&lt;/p>
&lt;p>Make sure you have &lt;a href="https://www.docker.com/">Docker&lt;/a> installed. Docker doesn’t work very well if it isn’t installed.&lt;/p>
&lt;p>Now is also a good time to tell you to….wait for it….install the &lt;a href="https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-docker&amp;amp;WT.mc_id=ignite2019-urlist-buhollan">Docker extension for VS Code&lt;/a>. Come on. You knew that was coming.&lt;/p>
&lt;p>First, we need to add a &lt;code>Dockerfile&lt;/code> to our project. You can just drop that in the root.&lt;/p>
&lt;p>&lt;img src="https://miro.medium.com/max/2784/1*yvq3BMrKuf-aMG1arlvlTg.png" alt="">&lt;/p>
&lt;p>To run the site in a container, we need a web server. Since we’re on a Node kick, we’ll just keep working with “serve”.&lt;/p>
&lt;blockquote>
&lt;p>Check out &lt;a href="https://gist.github.com/willurd/5720255">this gist&lt;/a> I found that shows you a bunch of different web servers that you can get running for static sites in about one line. Any of these would work in Docker.&lt;/p>
&lt;/blockquote>
&lt;p>Our Docker file with “serve” looks like this…&lt;/p>
&lt;pre>&lt;code>FROM node:alpine
# Copy in dist
COPY ./dist /app
# Install serve
RUN npm i -g serve
# Start it up
CMD serve /app -s
&lt;/code>&lt;/pre>
&lt;p>Build it with VS Code by selecting “Docker: Build Image” from the Command Palette.&lt;/p>
&lt;p>&lt;img src="https://miro.medium.com/max/2784/1*dFnsJSaDEpvtB0ZyZ3R85A.png" alt="">&lt;/p>
&lt;p>The image will then show up in VS Code under the “Docker” explorer.&lt;/p>
&lt;p>&lt;img src="https://miro.medium.com/max/2784/1*9hyAvTUWZXs9RzYHygnStA.png" alt="">&lt;/p>
&lt;p>Now push it to Docker Hub. To do that, expand the node and right-click the “latest” image and select select “tag”. You then need to enter your Docker Hub username first. The “latest” tag just means that this is the latest version of this image. Right-click it again and select “Push”. This should push it to Docker Hub. If it fails or says “Access Denied”, make sure you are signed into Docker Hub via the terminal…&lt;/p>
&lt;pre>&lt;code>$ docker login
&lt;/code>&lt;/pre>
&lt;p>Now that the image is up in Docker Hub, we can pull it into Azure. We need a site to do that. We could configure that through the portal, but that’s…not very exciting, so let’s do with the &lt;a href="https://docs.microsoft.com/cli/azure/install-azure-cli?view=azure-cli-latest&amp;amp;WT.mc_id=personal-medium-buhollan">Azure CLI&lt;/a>. Also, this article is getting long and my fingers are tired. Your eyes are probably bleeding.&lt;/p>
&lt;p>Create a Resource Group…&lt;/p>
&lt;pre>&lt;code>$ az group create -n deleteme-vue-docker
&lt;/code>&lt;/pre>
&lt;p>Create a Service Plan. Remember — this is where we choose how much resources we want from Azure. In other words, this is where you spend money.&lt;/p>
&lt;pre>&lt;code>$ az appservice plan create -n vuedocker -g deleteme-vue-docker — is-linux -l “East US” — sku S1
&lt;/code>&lt;/pre>
&lt;p>Create the new instance and pull in the container from Docker Hub…&lt;/p>
&lt;pre>&lt;code>$ az webapp create -n vue-docker -g deleteme-vue-docker -p vuedocker -i burkeholland/frontend-vue-typescript:latest
&lt;/code>&lt;/pre>
&lt;p>After that command finishes, if you scroll back up through the CLI output, you’ll see the URL of your site…&lt;/p>
&lt;p>&lt;img src="https://miro.medium.com/max/2784/1*Kf0GREvsy7b0Meo6bcXopA.png" alt="">&lt;/p>
&lt;blockquote>
&lt;p>Disclaimer: It’s a good idea to use a more full-featured web server in production than just “serve”. The reason for this is that “serve” is fairly simple and does not have some of the advanced features you might want in the future. This would be things like gzip or brottli compression, max worker connections, MIME type mappings and more. For that, I would recommend using &lt;a href="https://hub.docker.com/_/nginx/">nginx&lt;/a>. It’s not nearly as simple to setup, but it’s got all the bells and whistles.&lt;/p>
&lt;/blockquote>
&lt;h2 id="anddone">And…..DONE&lt;/h2>
&lt;p>Are you still with me? How many people did we lose along the way? Who died of dysentery?&lt;/p>
&lt;p>For those who are still awake, alert, alive and enthusiastic, let’s recap what we now know about hosting static sites in Azure.&lt;/p>
&lt;ul>
&lt;li>Preferred: Azure Storage&lt;/li>
&lt;li>Azure App Service for Linux with an &lt;code>ecosystem.config.js&lt;/code> file&lt;/li>
&lt;li>Azure App Service for Windows with a &lt;code>web.config&lt;/code>&lt;/li>
&lt;li>Azure App Service with a container&lt;/li>
&lt;/ul>
&lt;p>Choose your own destiny. Here are some additional links you might find helpful in your static site quest. Godspeed.&lt;/p></description></item><item><title>The Urlist — An application study in Serverless and Azure</title><link>https://burkeholland.github.io/posts/the-urlist/</link><pubDate>Sat, 04 May 2019 08:47:17 -0600</pubDate><guid>https://burkeholland.github.io/posts/the-urlist/</guid><description>&lt;p>Today we are pleased to announce that we (&lt;a href="https://twitter.com/burkeholland">Burke Holland&lt;/a> and &lt;a href="https://twitter.com/cecilphillip">Cecil Phillip&lt;/a>) are releasing a project called “The Urlist”. You can access it starting today at &lt;a href="https://theurlist.com">theurlist.com&lt;/a>.&lt;/p>
&lt;p>The Urlist is an application that lets you create lists of url’s that you can share with others. Get it? A list of URL’s? The Urlist? Listen, naming things is hard and all the good domains are already taken.&lt;/p>
&lt;p>This project was born out of a realization that I was ending my presentations with a slide full of links to additional resources. That’s crazy! What exactly is the audience supposed to do with that? Take a picture with their phone and then go back and manually type it all in later? What decade is this!?&lt;/p>
&lt;p>What I wanted was one, easy to remember URL that would point to the full list of resources from my session. I was surprised when I found that there weren’t a lot of options out there for doing this.&lt;/p>
&lt;p>So I enlisted the help of my friend &lt;a href="https://twitter.com">Cecil Phillip&lt;/a> and over the past several months we’ve been steadily working on this project. We debuted it last week at Microsoft BUILD 2019, and today we’re making it available to everyone.&lt;/p>
&lt;p>&lt;img src="https://cdn-images-1.medium.com/max/2764/1*uJsveuzVwZLOsczYcaZArQ.png" alt="">&lt;/p>
&lt;p>The app is pretty simple — you just start adding links that you want to group together. The app uses the Open Graph information on the site to get a title and description for your link automatically.&lt;/p>
&lt;p>&lt;img src="https://cdn-images-1.medium.com/max/2764/1*SKik0Vj9-CMTtc7rXHX0Kg.png" alt="">&lt;/p>
&lt;p>You can give your list a custom url and a description. If you don’t select a custom url, it generates one for you. When you click publish, you get a URL that points directly to all of your links. That’s it! Think of it like bit.ly, but for a bunch of links.&lt;/p>
&lt;p>&lt;img src="https://cdn-images-1.medium.com/max/2764/1*CQ7gPgbGiSezu8CiK9YNDQ.png" alt="">&lt;/p>
&lt;p>You don’t have to log in, but if you do, you can publish and then go back and manage your lists. Otherwise, your list is created anonymously and once you publish it, it’s final. Right now we only support Twitter login.&lt;/p>
&lt;p>&lt;img src="https://cdn-images-1.medium.com/max/2764/1*eY4bc_HZG8u0R4XLkkx0Tw.png" alt="">&lt;/p>
&lt;p>We had a dual motive in building this application. While we were trying to solve a problem, we were also trying to learn how to build a &lt;em>truly&lt;/em> serverless application on Azure. And we wanted a real-world use case — not a contrived example that served no actual purpose. That’s why this entire project is &lt;a href="https://github.com/the-urlist">open source&lt;/a>.&lt;/p>
&lt;h2 id="frontend-vue--typescript">&lt;strong>Frontend: Vue + TypeScript&lt;/strong>&lt;/h2>
&lt;p>The frontend is a single page app written with Vue and TypeScript. I specifically chose those two technologies because TypeScript is becoming astonishingly popular, and I wanted to see what the experience would be like with Vue.&lt;/p>
&lt;p>There’s a lot to unpack in that experience, but suffice to say that it was insightful.&lt;/p>
&lt;p>Having done it, &lt;strong>I don’t think I’m sold on the value of TypeScript for a project of this size&lt;/strong>. Strong typing is a tax. You pay the tax in exchange for better maintainability and tooling, but in a project of this size, there simply isn’t enough scale to justify the expense. I feel like there is an intersection between the lines of code in a project and when TypeScript becomes valuable. I just never reached that intersection in this project.&lt;/p>
&lt;p>&lt;img src="https://cdn-images-1.medium.com/max/2000/1*wCZlJqdnfc3i5PAgI8VZZw.png" alt="It’s not a great chart — I know. I made it in PowerPoint.">&lt;em>It’s not a great chart — I know. I made it in PowerPoint.&lt;/em>&lt;/p>
&lt;p>There is also the issue of the extensive ecosystem of Vue components, many of which do not already have typings. That leaves you in a spot where it feels like you have to coerce TypeScript into doing things that it doesn’t want to do. You end up writing “any” and “declare” a whole lot, which is basically like screaming, “LOOK AWAY, TYPESCRIPT!”&lt;/p>
&lt;p>While on the subject of Vue Components, we used a few in this app that I think are just wonderful.&lt;/p>
&lt;p>We used the &lt;a href="https://github.com/euvl/vue-js-modal">Vue Modal component&lt;/a> for…..…..modals.&lt;/p>
&lt;p>&lt;img src="https://cdn-images-1.medium.com/max/2764/1*VF2Hl-HeLGwCoCX3yzQAiw.png" alt="">&lt;/p>
&lt;p>We used the &lt;a href="https://github.com/Jexordexan/vue-slicksort">SlickSort component&lt;/a> for drag and drop sorting. This component is really cool. I like it a lot and I have no idea how it works, but it works. It even works on mobile.&lt;/p>
&lt;p>&lt;img src="https://cdn-images-1.medium.com/max/2540/1*zJH8SCydCDEYb9vf3_1RuQ.gif" alt="">&lt;/p>
&lt;p>And &lt;a href="https://vuelidate.netlify.com/">Vuelidate&lt;/a> for validation — including async validation that requires us to check with the API to see if a chosen url is available.&lt;/p>
&lt;p>&lt;img src="https://cdn-images-1.medium.com/max/2540/1*04WSOFX4HWlXEBLnmWw4ng.gif" alt="">&lt;/p>
&lt;p>The frontend is hosted on &lt;a href="https://docs.microsoft.com/en-us/azure/storage/blobs/storage-blob-static-website-host?WT.mc_id=personal-blog-buhollan">Azure Storage&lt;/a>. This is partly why we call it “Serverless”. Since Vue apps compile down to just static HTML, CSS, JavaScript and Image files, we can just host it on Azure Storage.&lt;/p>
&lt;p>It’s “Serverless” because it scales indefinitely and we only pay for what we use. In the case of Azure Storage, we pay $0.0184 per GB. The size of our entire dist folder — images and all is 1.8 MB.&lt;/p>
&lt;p>We also pay for bandwidth usage here. It costs us 8 cents per GB, but the first 5 GB every month are free. So our application has to see solid usage before we pay anything at all for bandwidth.&lt;/p>
&lt;p>Azure Storage is definitely the best way to host static sites. It’s got no overhead and it’s crazy fast. There is no container to startup. No Node server to run. You just…..can’t beat this type of hosting for single page apps.&lt;/p>
&lt;h2 id="backend-azure-functions--dotnot-core">Backend: Azure Functions + Dotnot Core&lt;/h2>
&lt;p>Cecil wrote the API with C# using &lt;a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-create-first-azure-function?WT.mc_id=personal-blog-buhollan">Azure Functions&lt;/a>. Functions is what we typically think of when someone says “serverless”. It’s the product that Microsoft positions for that market and probably falls more in line with what’s in your head when someone drops that word at a dinner party.&lt;/p>
&lt;p>We chose to build the API in C# because we wanted to mix and match technologies like you might out in a real-world application. We could have had a JavaScript stack through and through, but working across technologies gave us both a chance to widen our horizons.&lt;/p>
&lt;p>Each API endpoint has a corresponding Function. Cecil named those Functions so it’s relatively easy to figure out what they do just by looking at the names.&lt;/p>
&lt;p>&lt;img src="https://cdn-images-1.medium.com/max/2764/1*hoGLgHhT9P1Qq83C8CXVtw.png" alt="">&lt;/p>
&lt;p>He used the built-in routing capability in Azure Functions to make them RESTful endpoints. The beauty of this is that when you are working on the methods, they make sense to humans. When you are consuming them, they make sense as an API.&lt;/p>
&lt;p>&lt;img src="https://cdn-images-1.medium.com/max/2764/1*2LPCU4kCNBKMvQufNBv2jg.png" alt="">&lt;/p>
&lt;p>We also used the built-in authentication mechanism that Functions exposes via Azure’s AppService Authentication. We chose to do a social login only since we didn’t see a need to store usernames and passwords. On Cecil’s end, he followed the instructions in the “Authentication” section of the Azure Portal for our Functions app to set up a new application in Twitter and then copied the keys over.&lt;/p>
&lt;p>&lt;img src="https://cdn-images-1.medium.com/max/2764/1*xs3xIelOxtFvy6DgccjQrQ.png" alt="Relax, these aren’t our actual keys">&lt;em>Relax, these aren’t our actual keys&lt;/em>&lt;/p>
&lt;p>This lights up the /.auth endpoints in our Function app. We can now call these endpoints from our frontend and it will direct the user through the auth flow. For instance, if we want to log them in and then redirect them back to the application, we just have our “Log In” button go to this URL…&lt;/p>
&lt;pre>&lt;code>https://www.theurlist.com/.auth/login/twitter?post_login_redirect_url=https://www.theurlist.com
&lt;/code>&lt;/pre>
&lt;p>This sends the user over to Twitter to authenticate, and then back to our application. When they come back, they now have an auth cookie attached to their session. We can see that if we look at the cookies in the dev tools.&lt;/p>
&lt;p>&lt;img src="https://cdn-images-1.medium.com/max/2764/1*X3QT6vNZ5sqI4roSaofrzg.png" alt="">&lt;/p>
&lt;p>Now we can ask for information that Twitter has on the user. These are things like username, full name, avatar — ect. We do that by calling the “me” endpoint that got lit up automatically when we turned on authentication.&lt;/p>
&lt;pre>&lt;code>https://www.theurlist.com/.auth/me
&lt;/code>&lt;/pre>
&lt;p>&lt;img src="https://cdn-images-1.medium.com/max/2764/1*kJ1vdPEdXAasbxgkoIvKOg.png" alt="">&lt;/p>
&lt;p>And Cecil can now validate every request I make to the API from the frontend and get the same user information. This is how we figure out what lists are yours, and whether or not you have the right to edit them.&lt;/p>
&lt;p>&lt;img src="https://cdn-images-1.medium.com/max/2764/1*naJSalTFtawofi9JiPf3wg.png" alt="">&lt;/p>
&lt;h2 id="cosmos-db--sql-api">Cosmos DB + SQL API&lt;/h2>
&lt;p>For our data store, we used Cosmos DB and the SQL API. This allowed us to have a NoSQL data store that we could still query with SQL. I find that NoSQL is great until you need to do something beyond just a trivial query. Then everything starts to feel like chaos to me and I think of this slide from James Mickens &lt;a href="https://vimeo.com/95066828">“Computers are a sadness, I am the cure”&lt;/a>.&lt;/p>
&lt;p>&lt;img src="https://cdn-images-1.medium.com/max/2000/1*2bgFm8pty2RJ0uYCVVG-Dw.png" alt="">&lt;/p>
&lt;p>There’s also a nifty Cosmos DB extension for VS Code which makes it quite a bit easier to work with our documents and actually see the database. &lt;a href="https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-cosmosdb&amp;amp;WT.mc_id=personal-blog-buhollan">&lt;strong>Azure Cosmos DB - Visual Studio Marketplace&lt;/strong> *Get it now.*marketplace.visualstudio.com&lt;/a>&lt;/p>
&lt;p>There is just no substitute for being able to see your database when you are starting from the ground up. Being able to see it within VS Code is even better.&lt;/p>
&lt;p>&lt;img src="https://cdn-images-1.medium.com/max/2764/1*VLCFBhGvhPEi_vemo46qDw.png" alt="">&lt;/p>
&lt;p>Cosmos DB is one spot where our application is not, strictly speaking, serverless.&lt;/p>
&lt;p>Cosmos DB runs us ~25$ per month which gets us 100 RU’s, or “Request Units per Second”. We have to buy those up front each month, and even if we don’t use all that, we still pay for it. We are also capped there, so if our application gets super popular, we have to manually scale out by reserving more RU’s.&lt;/p>
&lt;h2 id="azure-front-door">Azure Front Door&lt;/h2>
&lt;p>We use Azure Front Door to glue the frontend and the backend together. Here’s what I mean by that…&lt;/p>
&lt;p>Our frontend runs on Azure Storage and its URL is &lt;a href="https://theurlistdotcom.z19.web.core.windows.net/">https://theurlistdotcom.z19.web.core.windows.net/&lt;/a>&lt;/p>
&lt;p>Our backend runs on Azure Functions and its URL is &lt;a href="https://linky-link.azurewebsites.net/api">https://linky-link.azurewebsites.net/api&lt;/a>.&lt;/p>
&lt;p>What we wanted was to have one domain — theurlist.com. We wanted the root to point to our Vue app, and /api to point to our API.&lt;/p>
&lt;p>To pull this off, we used a new product called &lt;a href="https://docs.microsoft.com/en-us/azure/frontdoor/quickstart-create-front-door?WT.mc_id=personal-blog-buhollan">Azure Front Door&lt;/a>.&lt;/p>
&lt;p>Front Door bills itself as a tool for “highly available global applications”.&lt;/p>
&lt;p>In our case, we were less interested in that and more interested in it’s ability to let us stand up an entry point for our application and organize all of the pieces behind that single point of entry.&lt;/p>
&lt;p>Front Door works via a visual designer interface. It starts off by giving you a “Frontend Host”. By default you get…&lt;appname>.azurefd.net. That’s the URL via which you can access your site. You can also add a custom domain which we’ll do in a second.&lt;/appname>&lt;/p>
&lt;p>&lt;img src="https://cdn-images-1.medium.com/max/2764/1*U3Vu1ZdXCJB9EGwGKMgMNQ.png" alt="">&lt;/p>
&lt;p>It then wants you to identify “Backend Pools”. These are just the resources that you want to direct traffic to. For us, that’s the static site on the frontend, and the Functions app on the backend. I’ve just called mine “urlist-frontend” and “urlist-backend”. If you look inside them, they point to Storage and Functions respectively.&lt;/p>
&lt;p>&lt;img src="https://cdn-images-1.medium.com/max/2764/1*Hx92izN0y4gV91_VOIcFdA.png" alt="">&lt;/p>
&lt;p>Last, we have the routes that we want to define.&lt;/p>
&lt;p>&lt;img src="https://cdn-images-1.medium.com/max/2764/1*RSG9B1U64mMza_hK_7vyUQ.png" alt="">&lt;/p>
&lt;p>In our case, we have four routes…&lt;/p>
&lt;ol>
&lt;li>
&lt;p>The root of our site, which points to urlist-frontend in our “Backend pools”&lt;/p>
&lt;/li>
&lt;li>
&lt;p>/api which points to urlist-backend in our “Backend pools”&lt;/p>
&lt;/li>
&lt;li>
&lt;p>/.auth which points to urlist-backend in our “Backend pools”&lt;/p>
&lt;/li>
&lt;li>
&lt;p>A route which redirects all http traffic to https&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>Our custom domain gets added to the “Frontend hosts” section. We add a new domain by pointing to theurlist.azurefd.net with a www CNAME in our DNS. Front Door then verifies that is the case, and magically creates and assigns us an SSL certificate for &lt;a href="http://www.theurlist.com.">www.theurlist.com&lt;/a>. Not having to configure SSL was….kind of amazing.&lt;/p>
&lt;p>Front Door also acts as a CDN for our app. It’s just sort of built-in to the product. That means that we are cached at the edge around the globe which just increases the speed at which we can get the app into people’s browsers.&lt;/p>
&lt;h2 id="solving-the-a-record-problem">Solving The A Record Problem&lt;/h2>
&lt;p>The last thing we had to do was figure out how to get Azure Front Door behind an A record.&lt;/p>
&lt;p>When you stand up a custom domain, you need to give it an A record. This is often called a “naked domain”. It’s just the domain, without www. In our case, that’s theurlist.com. The problem is that A records have to be an IP address, and Front Door doesn’t give us an IP. It only gives us that theurlist.azurefd.net.&lt;/p>
&lt;p>To solve this, we decided to simply redirect any traffic coming to theurlist.com over to &lt;a href="http://www.theurlist.com.">www.theurlist.com.&lt;/a>&lt;/p>
&lt;p>I registered the domain with NameCheap, but I was unable to get their redirect rules to reliably work. In the end, we stood up a Cloudflare instance as our DNS. Cloudflare allows us to create a CNAME for the root (@) and point it at &lt;a href="https://www.theurlist.com">www.theurlist.com&lt;/a>. Now we already said you can’t do this — and you can’t according to the DNS spec. But Cloudflare allows it with something called “CNAME Flattening”.&lt;/p>
&lt;h3 id="cname-flattening">CNAME Flattening&lt;/h3>
&lt;p>When you create a CNAME and point it at the root, Cloudflare basically resolves the IP of theurlist.azurefd.net and that’s what get’s returned as the A record. The problem is that in the case of Front Door, we can’t go directly to the IP, because the IP is the load balancer. It doesn’t know which site we want if we just navigate to the IP.&lt;/p>
&lt;p>&lt;img src="https://cdn-images-1.medium.com/max/2764/1*e9Luold75LuZILF2LPNYww.png" alt="">&lt;/p>
&lt;p>Since we are already going through Cloudflare to resolve our domain, we can add a page rule in Cloudflare to capture all traffic and redirect it. That orange cloud in the image above indicates that traffic flows through Cloudflare’s HTTP proxy. That’s how we can capture it and redirect it with a page rule.&lt;/p>
&lt;p>&lt;img src="https://cdn-images-1.medium.com/max/2764/1*OeaUh43csd_GnsdBZ84RrA.png" alt="">&lt;/p>
&lt;p>It took me a while to figure out what I had to use a *in my path to capture the rest of the path, and then a $1 in the redirect to pass it through.&lt;/p>
&lt;p>This gives us a naked domain without needing an IP address. Ship it.&lt;/p>
&lt;p>Azure Front Door is priced by route. The first five routes cost $21 total. Outside of that, it is consumption based at around 25 cents per GB transferred. There is a little up-front cost here, but we get a lot more with Front Door than just an endpoint…&lt;/p>
&lt;ul>
&lt;li>
&lt;p>SSL&lt;/p>
&lt;/li>
&lt;li>
&lt;p>CDN&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Global HTTP balancing&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Application acceleration&lt;/p>
&lt;/li>
&lt;li>
&lt;p>System health monitoring&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="share-the-internet">Share the internet&lt;/h2>
&lt;p>I came up with that tag line myself. Do you like it? Should I go on Shark Tank? Are we going to IPO this year?&lt;/p>
&lt;p>We think this application is interesting not just because it shows how &lt;em>we&lt;/em> would build a web application, but also because we think that the &lt;em>way&lt;/em> we’ve leveraged Azure provides the &lt;strong>maximum amount of speed and scale for the dollar&lt;/strong>.&lt;/p>
&lt;p>If you’re interested, you can check out Build 2019 session on The Urlist called, “The good, the bad and the ugly of serverless”.&lt;/p>
&lt;center>&lt;iframe width="560" height="315" src="https://www.youtube.com/embed/T5ULvFk134U" frameborder="0" allowfullscreen="">&lt;/iframe>&lt;/center>
&lt;p>We hope that this application is useful for you not just from a code and architecture standpoint, but also as an actual application that you can use to share your links. We’d love to see your &lt;a href="https://github.com/the-urlist">issues and PR’s&lt;/a>!&lt;/p></description></item><item><title>GitLens with Eric Amodio</title><link>https://burkeholland.github.io/posts/git-lens-eric/</link><pubDate>Fri, 07 Dec 2018 08:49:37 -0600</pubDate><guid>https://burkeholland.github.io/posts/git-lens-eric/</guid><description>&lt;p>There are only two kinds of people in the world: those who are utterly confused by Git, and those who refuse to admit it.&lt;/p>
&lt;center>![](https://cdn-images-1.medium.com/max/2000/1*hvJgiUToHU6NEGzy397LbA.jpeg)&lt;/center>
&lt;p>Well, ok, there are probably &lt;em>some&lt;/em> people who understand it, but I’m definitely not one of them.&lt;/p>
&lt;p>As a result, people like me (which is most of us — zero evidence to prove that so just accept it as fact and let it wash over you) tend to learn the base amount of Git that we need to get by (clone, pull, add, commit) and the rest we try really hard to avoid because we have zero confidence that we’ll be able to do it without breaking literally everything.&lt;/p>
&lt;p>GitLens is an extension for VS Code that puts virtually all of the functionality of Git into the editor. You then get a visual interface for all Git actions, and anytime you can actually SEE what you are doing, things get exponentially easier.&lt;/p>
&lt;p>&lt;a href="https://marketplace.visualstudio.com/items?itemName=eamodio.gitlens?WT.mc_id=none-medium-buhollan">GitLens for VS Code&lt;/a>&lt;/p>
&lt;p>I wanted to really get to know GitLens, because I want to stop living in fear of Git. So I sat down with the creator of GitLens, Eric Amodio, and asked him to walk me through the extension, and how it works. I figured, if anyone knows Git, it’s probably this guy.&lt;/p>
&lt;p>So here’s 45 minutes of yours truly stumbling through what might be the best extension for VS Code, and one very patient extension creator who was nice enough to show me the way.&lt;/p>
&lt;center>&lt;iframe width="560" height="315" src="https://www.youtube.com/embed/YSgDQHyQASk" frameborder="0" allowfullscreen="">&lt;/iframe>&lt;/center></description></item></channel></rss>