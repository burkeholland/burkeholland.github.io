<!doctype html><html lang=en-us>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<title>Converting Cosmos DB Timestamps to JavaScript Dates - Burke Knows Words</title>
<meta name=description content="Cosmos DB automactially adds a timestamp field called &ldquo;_ts&rdquo;. everytime a document is created or updated. And it looks like this&mldr;
{ &#34;_ts&#34;: 1628083065 } That number is described by this blog post as an &ldquo;epoch value in seconds (not milliseconds) since an item was last modified.&rdquo; The number of seconds since what? Well, the number of seconds since January 1st, 1970 to be exact. This is a Unix date format (aslo called &ldquo;epoch&rdquo;) and you can use JavaScript to convert that into a date object that you can actually use.">
<meta name=author content>
<link href=https://burkeholland.github.io/an-old-hope.min.css rel=stylesheet>
<link href=https://burkeholland.github.io/style.css rel=stylesheet>
<link href=https://burkeholland.github.io/custom.css rel=stylesheet>
<link rel=apple-touch-icon href=https://burkeholland.github.io/apple-touch-icon.png>
<link rel=icon href=https://burkeholland.github.io/favicon.ico>
<meta name=generator content="Hugo 0.89.0">
<script>function setTheme(){if(window.matchMedia('(prefers-color-scheme: dark)').matches){document.body.classList.add('dark');return}const c=new Date,g=localStorage.getItem('date'),d=String(c.getMonth()+1)+'.'+String(c.getDate()),e=c.getTime();let a,b;function f(){if(e>a&&e<b)return;document.body.classList.add('dark')}d!==g?(fetch('https://api.ipgeolocation.io/astronomy?apiKey=5ed37d85103e4defa5df4c5298ed5215').then(a=>a.json()).then(c=>{a=c.sunrise.split(':').map(Number),b=c.sunset.split(':').map(Number)}).catch(()=>{a=[7,0],b=[19,0]}).finally(()=>{a=c.setHours(a[0],a[1],0),b=c.setHours(b[0],b[1],0),f(),localStorage.setItem('sunrise',a),localStorage.setItem('sunset',b)}),localStorage.setItem('date',d)):(a=Number(localStorage.getItem('sunrise')),b=Number(localStorage.getItem('sunset')),f())}</script>
</head>
<body class=single>
<script>setTheme()</script>
<header class=header>
<nav class=nav>
<p class=logo><a href=https://burkeholland.github.io/>Burke Knows Words</a></p>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<h1 class=post-title>Converting Cosmos DB Timestamps to JavaScript Dates</h1>
<div class=post-meta>August 5, 2021</div>
</header>
<div class=post-content><p>Cosmos DB automactially adds a timestamp field called &ldquo;_ts&rdquo;. everytime a document is <strong>created</strong> or <strong>updated</strong>. And it looks like this&mldr;</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json>{
  <span style=color:#f92672>&#34;_ts&#34;</span>: <span style=color:#ae81ff>1628083065</span>
}
</code></pre></div><p>That number is described by <a href="https://devblogs.microsoft.com/cosmosdb/new-date-and-time-system-functions/?WT.mc_id=devcloud-0000-buhollan#converting-the-system-_ts-property-to-a-datetime-string">this blog post</a> as an &ldquo;epoch value in seconds (not milliseconds) since an item was last modified.&rdquo; The number of seconds since what? Well, the number of seconds since January 1st, 1970 to be exact. This is a Unix date format (aslo called &ldquo;epoch&rdquo;) and you can use JavaScript to convert that into a date object that you can actually use.</p>
<h2 id=converting-javascript-date>Converting JavaScript Date</h2>
<p>You can create a JavaScript Date object from an epoch value by just passing the value to the Date constructor. HOWEVER; the <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/Date>docs for the JavaScript Date object</a> say that &ldquo;Date objects contain a number that respresents the number of <em>milliseconds</em> since January 1, 1970.&rdquo; By contrast, the Cosmos DB <code>_ts</code> property is the number of <em>seconds</em> since January 1, 1970. So in order to get the correct time, we have to multiply the _ts value by 1000 so that it&rsquo;s milliseconds instead of seconds. So the final answer looks like this&mldr;</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>d</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Date(<span style=color:#a6e22e>_ts</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>1000</span>);
<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>d</span>.<span style=color:#a6e22e>toDateString</span>());

<span style=color:#75715e>// OUPTUT: &#39;Wed Aug 04 2021&#39;
</span></code></pre></div></div>
</article></main>
<footer class=footer>
<span>&copy; 2021 <a href=https://burkeholland.github.io/>Burke Knows Words</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel=noopener target=_blank>Hugo️️</a>️</span>
<span>&#183;</span>
<span>Theme️ <a href=https://github.com/nanxiaobei/hugo-paper rel=noopener target=_blank>Paper</a></span>
</footer>
<script src=https://burkeholland.github.io/highlight.min.js></script>
<script>hljs.initHighlightingOnLoad()</script>
</body>
</html>